69c730103a3a8ab4ed917ca2a760b6c4
/**
 * Recommendations Component Module
 * 
 * This module exports the existing recommendations component
 * in a format compatible with the new Vite-based system.
 */

import { fetchData } from '../utils/api.js';

// For now, we'll create a simple wrapper that maintains backward compatibility
// Later, this can be refactored to use proper ES modules

export function createRecommendationsComponent() {
  // Check if the legacy component creator exists
  if (typeof window !== 'undefined' && window.createRecommendationsComponent) {
    return window.createRecommendationsComponent();
  }

  // Fallback component if the legacy one isn't available
  return {
    // Initialization state (required for x-show guards)
    isInitialized: false,
    isLoading: false,
    loading: false,
    showToast: false,
    toastMessage: '',
    toastType: 'success',
    // Tab state
    activeTab: 'similarity',
    // Available LoRAs
    availableLoras: [],
    // Similarity explorer
    selectedLoraId: '',
    selectedLora: null,
    weights: {
      semantic: 0.6,
      artistic: 0.3,
      technical: 0.1
    },
    similarityLimit: 10,
    similarityThreshold: 0.1,
    // Prompt-based recommendations
    promptText: '',
    promptLimit: 10,
    promptIncludeInactive: false,
    promptSuggestions: ['anime girl with pink hair', 'realistic portrait photography', 'fantasy landscape with magic', 'cyberpunk character design', 'traditional art style', 'watercolor painting effect', 'detailed facial features', 'medieval fantasy armor', 'modern city background', 'artistic lighting effects'],
    // Embedding status - THESE WERE MISSING
    computingEmbeddings: false,
    rebuildingIndex: false,
    embeddingProgress: 0,
    embeddingStatus: 'Ready',
    // Import/Export state (for compatibility)
    exportConfig: {
      loras: false,
      lora_files: false,
      lora_metadata: false,
      lora_embeddings: false,
      generations: false,
      generation_range: 'all',
      date_from: '',
      date_to: '',
      user_data: false,
      system_config: false,
      analytics: false,
      format: 'zip',
      compression: 'balanced',
      split_archives: false,
      max_size_mb: 1024,
      encrypt: false,
      password: ''
    },
    importConfig: {
      mode: 'merge',
      conflict_resolution: 'ask',
      validate: true,
      backup_before: true,
      password: ''
    },
    isExporting: false,
    isImporting: false,
    estimatedSize: '0 MB',
    estimatedTime: '0 minutes',
    importFiles: [],
    importPreview: [],
    backupHistory: [],
    hasEncryptedFiles: false,
    showProgress: false,
    progressTitle: '',
    progressStep: '',
    progressPercent: 0,
    progressMessages: [],
    migrationProgress: {
      active: false,
      current_step: '',
      completed: 0,
      total: 100,
      status: 'idle',
      logs: []
    },
    init() {
      // Initialize the component
      this.loadAvailableLoras();
      this.isInitialized = true;
    },
    async loadAvailableLoras() {
      this.isLoading = true;
      try {
        const data = await fetchData((window?.BACKEND_URL || '') + '/adapters');
        this.availableLoras = data.items || data || [];
      } catch (error) {
        // Handle error silently or use proper error reporting
        this.showToastMessage('Failed to load LoRAs', 'error');
      } finally {
        this.isLoading = false;
      }
    },
    loadSelectedLora() {
      if (this.selectedLoraId) {
        this.selectedLora = this.availableLoras.find(lora => lora.id === this.selectedLoraId);
        this.updateRecommendations();
      }
    },
    updateRecommendations() {
      if (this.selectedLoraId) {
        // Trigger similarity search (placeholder)
      }
    },
    searchByPrompt() {
      if (this.promptText.trim()) {
        // Trigger prompt-based search (placeholder)
      }
    },
    resetWeights() {
      this.weights = {
        semantic: 0.6,
        artistic: 0.3,
        technical: 0.1
      };
      this.updateRecommendations();
    },
    async computeAllEmbeddings() {
      this.computingEmbeddings = true;
      this.embeddingProgress = 0;
      this.embeddingStatus = 'Starting embedding computation...';
      try {
        // Simulate progress
        for (let i = 0; i <= 100; i += 10) {
          this.embeddingProgress = i;
          this.embeddingStatus = `Computing embeddings... ${i}%`;
          await new Promise(resolve => setTimeout(resolve, 100));
        }
        this.embeddingStatus = 'Embeddings computed successfully!';
        this.showToastMessage('Embeddings computed successfully!', 'success');
      } catch (error) {
        this.embeddingStatus = 'Failed to compute embeddings';
        this.showToastMessage('Failed to compute embeddings', 'error');
      } finally {
        setTimeout(() => {
          this.computingEmbeddings = false;
        }, 2000);
      }
    },
    async rebuildIndex() {
      this.rebuildingIndex = true;
      this.embeddingProgress = 0;
      this.embeddingStatus = 'Rebuilding similarity index...';
      try {
        // Simulate progress
        for (let i = 0; i <= 100; i += 20) {
          this.embeddingProgress = i;
          this.embeddingStatus = `Rebuilding index... ${i}%`;
          await new Promise(resolve => setTimeout(resolve, 150));
        }
        this.embeddingStatus = 'Index rebuilt successfully!';
        this.showToastMessage('Index rebuilt successfully!', 'success');
      } catch (error) {
        this.embeddingStatus = 'Failed to rebuild index';
        this.showToastMessage('Failed to rebuild index', 'error');
      } finally {
        setTimeout(() => {
          this.rebuildingIndex = false;
        }, 2000);
      }
    },
    viewHealthReport() {
      window.open((window?.BACKEND_URL || '') + '/recommendations/health', '_blank');
    },
    showToastMessage(message, type = 'success') {
      this.toastMessage = message;
      this.toastType = type;
      this.showToast = true;

      // Auto-hide after 3 seconds
      setTimeout(() => {
        this.showToast = false;
      }, 3000);
    }
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJmZXRjaERhdGEiLCJjcmVhdGVSZWNvbW1lbmRhdGlvbnNDb21wb25lbnQiLCJ3aW5kb3ciLCJpc0luaXRpYWxpemVkIiwiaXNMb2FkaW5nIiwibG9hZGluZyIsInNob3dUb2FzdCIsInRvYXN0TWVzc2FnZSIsInRvYXN0VHlwZSIsImFjdGl2ZVRhYiIsImF2YWlsYWJsZUxvcmFzIiwic2VsZWN0ZWRMb3JhSWQiLCJzZWxlY3RlZExvcmEiLCJ3ZWlnaHRzIiwic2VtYW50aWMiLCJhcnRpc3RpYyIsInRlY2huaWNhbCIsInNpbWlsYXJpdHlMaW1pdCIsInNpbWlsYXJpdHlUaHJlc2hvbGQiLCJwcm9tcHRUZXh0IiwicHJvbXB0TGltaXQiLCJwcm9tcHRJbmNsdWRlSW5hY3RpdmUiLCJwcm9tcHRTdWdnZXN0aW9ucyIsImNvbXB1dGluZ0VtYmVkZGluZ3MiLCJyZWJ1aWxkaW5nSW5kZXgiLCJlbWJlZGRpbmdQcm9ncmVzcyIsImVtYmVkZGluZ1N0YXR1cyIsImV4cG9ydENvbmZpZyIsImxvcmFzIiwibG9yYV9maWxlcyIsImxvcmFfbWV0YWRhdGEiLCJsb3JhX2VtYmVkZGluZ3MiLCJnZW5lcmF0aW9ucyIsImdlbmVyYXRpb25fcmFuZ2UiLCJkYXRlX2Zyb20iLCJkYXRlX3RvIiwidXNlcl9kYXRhIiwic3lzdGVtX2NvbmZpZyIsImFuYWx5dGljcyIsImZvcm1hdCIsImNvbXByZXNzaW9uIiwic3BsaXRfYXJjaGl2ZXMiLCJtYXhfc2l6ZV9tYiIsImVuY3J5cHQiLCJwYXNzd29yZCIsImltcG9ydENvbmZpZyIsIm1vZGUiLCJjb25mbGljdF9yZXNvbHV0aW9uIiwidmFsaWRhdGUiLCJiYWNrdXBfYmVmb3JlIiwiaXNFeHBvcnRpbmciLCJpc0ltcG9ydGluZyIsImVzdGltYXRlZFNpemUiLCJlc3RpbWF0ZWRUaW1lIiwiaW1wb3J0RmlsZXMiLCJpbXBvcnRQcmV2aWV3IiwiYmFja3VwSGlzdG9yeSIsImhhc0VuY3J5cHRlZEZpbGVzIiwic2hvd1Byb2dyZXNzIiwicHJvZ3Jlc3NUaXRsZSIsInByb2dyZXNzU3RlcCIsInByb2dyZXNzUGVyY2VudCIsInByb2dyZXNzTWVzc2FnZXMiLCJtaWdyYXRpb25Qcm9ncmVzcyIsImFjdGl2ZSIsImN1cnJlbnRfc3RlcCIsImNvbXBsZXRlZCIsInRvdGFsIiwic3RhdHVzIiwibG9ncyIsImluaXQiLCJsb2FkQXZhaWxhYmxlTG9yYXMiLCJkYXRhIiwiQkFDS0VORF9VUkwiLCJpdGVtcyIsImVycm9yIiwic2hvd1RvYXN0TWVzc2FnZSIsImxvYWRTZWxlY3RlZExvcmEiLCJmaW5kIiwibG9yYSIsImlkIiwidXBkYXRlUmVjb21tZW5kYXRpb25zIiwic2VhcmNoQnlQcm9tcHQiLCJ0cmltIiwicmVzZXRXZWlnaHRzIiwiY29tcHV0ZUFsbEVtYmVkZGluZ3MiLCJpIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwicmVidWlsZEluZGV4Iiwidmlld0hlYWx0aFJlcG9ydCIsIm9wZW4iLCJtZXNzYWdlIiwidHlwZSJdLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUmVjb21tZW5kYXRpb25zIENvbXBvbmVudCBNb2R1bGVcbiAqIFxuICogVGhpcyBtb2R1bGUgZXhwb3J0cyB0aGUgZXhpc3RpbmcgcmVjb21tZW5kYXRpb25zIGNvbXBvbmVudFxuICogaW4gYSBmb3JtYXQgY29tcGF0aWJsZSB3aXRoIHRoZSBuZXcgVml0ZS1iYXNlZCBzeXN0ZW0uXG4gKi9cblxuaW1wb3J0IHsgZmV0Y2hEYXRhIH0gZnJvbSAnLi4vdXRpbHMvYXBpLmpzJztcblxuLy8gRm9yIG5vdywgd2UnbGwgY3JlYXRlIGEgc2ltcGxlIHdyYXBwZXIgdGhhdCBtYWludGFpbnMgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuLy8gTGF0ZXIsIHRoaXMgY2FuIGJlIHJlZmFjdG9yZWQgdG8gdXNlIHByb3BlciBFUyBtb2R1bGVzXG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVSZWNvbW1lbmRhdGlvbnNDb21wb25lbnQoKSB7XG4gICAgLy8gQ2hlY2sgaWYgdGhlIGxlZ2FjeSBjb21wb25lbnQgY3JlYXRvciBleGlzdHNcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LmNyZWF0ZVJlY29tbWVuZGF0aW9uc0NvbXBvbmVudCkge1xuICAgICAgICByZXR1cm4gd2luZG93LmNyZWF0ZVJlY29tbWVuZGF0aW9uc0NvbXBvbmVudCgpO1xuICAgIH1cbiAgICBcbiAgICAvLyBGYWxsYmFjayBjb21wb25lbnQgaWYgdGhlIGxlZ2FjeSBvbmUgaXNuJ3QgYXZhaWxhYmxlXG4gICAgcmV0dXJuIHtcbiAgICAgICAgLy8gSW5pdGlhbGl6YXRpb24gc3RhdGUgKHJlcXVpcmVkIGZvciB4LXNob3cgZ3VhcmRzKVxuICAgICAgICBpc0luaXRpYWxpemVkOiBmYWxzZSxcbiAgICAgICAgXG4gICAgICAgIGlzTG9hZGluZzogZmFsc2UsXG4gICAgICAgIGxvYWRpbmc6IGZhbHNlLFxuICAgICAgICBzaG93VG9hc3Q6IGZhbHNlLFxuICAgICAgICB0b2FzdE1lc3NhZ2U6ICcnLFxuICAgICAgICB0b2FzdFR5cGU6ICdzdWNjZXNzJyxcbiAgICAgICAgXG4gICAgICAgIC8vIFRhYiBzdGF0ZVxuICAgICAgICBhY3RpdmVUYWI6ICdzaW1pbGFyaXR5JyxcbiAgICAgICAgXG4gICAgICAgIC8vIEF2YWlsYWJsZSBMb1JBc1xuICAgICAgICBhdmFpbGFibGVMb3JhczogW10sXG4gICAgICAgIFxuICAgICAgICAvLyBTaW1pbGFyaXR5IGV4cGxvcmVyXG4gICAgICAgIHNlbGVjdGVkTG9yYUlkOiAnJyxcbiAgICAgICAgc2VsZWN0ZWRMb3JhOiBudWxsLFxuICAgICAgICB3ZWlnaHRzOiB7XG4gICAgICAgICAgICBzZW1hbnRpYzogMC42LFxuICAgICAgICAgICAgYXJ0aXN0aWM6IDAuMyxcbiAgICAgICAgICAgIHRlY2huaWNhbDogMC4xXG4gICAgICAgIH0sXG4gICAgICAgIHNpbWlsYXJpdHlMaW1pdDogMTAsXG4gICAgICAgIHNpbWlsYXJpdHlUaHJlc2hvbGQ6IDAuMSxcbiAgICAgICAgXG4gICAgICAgIC8vIFByb21wdC1iYXNlZCByZWNvbW1lbmRhdGlvbnNcbiAgICAgICAgcHJvbXB0VGV4dDogJycsXG4gICAgICAgIHByb21wdExpbWl0OiAxMCxcbiAgICAgICAgcHJvbXB0SW5jbHVkZUluYWN0aXZlOiBmYWxzZSxcbiAgICAgICAgcHJvbXB0U3VnZ2VzdGlvbnM6IFtcbiAgICAgICAgICAgICdhbmltZSBnaXJsIHdpdGggcGluayBoYWlyJyxcbiAgICAgICAgICAgICdyZWFsaXN0aWMgcG9ydHJhaXQgcGhvdG9ncmFwaHknLFxuICAgICAgICAgICAgJ2ZhbnRhc3kgbGFuZHNjYXBlIHdpdGggbWFnaWMnLFxuICAgICAgICAgICAgJ2N5YmVycHVuayBjaGFyYWN0ZXIgZGVzaWduJyxcbiAgICAgICAgICAgICd0cmFkaXRpb25hbCBhcnQgc3R5bGUnLFxuICAgICAgICAgICAgJ3dhdGVyY29sb3IgcGFpbnRpbmcgZWZmZWN0JyxcbiAgICAgICAgICAgICdkZXRhaWxlZCBmYWNpYWwgZmVhdHVyZXMnLFxuICAgICAgICAgICAgJ21lZGlldmFsIGZhbnRhc3kgYXJtb3InLFxuICAgICAgICAgICAgJ21vZGVybiBjaXR5IGJhY2tncm91bmQnLFxuICAgICAgICAgICAgJ2FydGlzdGljIGxpZ2h0aW5nIGVmZmVjdHMnXG4gICAgICAgIF0sXG4gICAgICAgIFxuICAgICAgICAvLyBFbWJlZGRpbmcgc3RhdHVzIC0gVEhFU0UgV0VSRSBNSVNTSU5HXG4gICAgICAgIGNvbXB1dGluZ0VtYmVkZGluZ3M6IGZhbHNlLFxuICAgICAgICByZWJ1aWxkaW5nSW5kZXg6IGZhbHNlLFxuICAgICAgICBlbWJlZGRpbmdQcm9ncmVzczogMCxcbiAgICAgICAgZW1iZWRkaW5nU3RhdHVzOiAnUmVhZHknLFxuICAgICAgICBcbiAgICAgICAgLy8gSW1wb3J0L0V4cG9ydCBzdGF0ZSAoZm9yIGNvbXBhdGliaWxpdHkpXG4gICAgICAgIGV4cG9ydENvbmZpZzoge1xuICAgICAgICAgICAgbG9yYXM6IGZhbHNlLFxuICAgICAgICAgICAgbG9yYV9maWxlczogZmFsc2UsXG4gICAgICAgICAgICBsb3JhX21ldGFkYXRhOiBmYWxzZSxcbiAgICAgICAgICAgIGxvcmFfZW1iZWRkaW5nczogZmFsc2UsXG4gICAgICAgICAgICBnZW5lcmF0aW9uczogZmFsc2UsXG4gICAgICAgICAgICBnZW5lcmF0aW9uX3JhbmdlOiAnYWxsJyxcbiAgICAgICAgICAgIGRhdGVfZnJvbTogJycsXG4gICAgICAgICAgICBkYXRlX3RvOiAnJyxcbiAgICAgICAgICAgIHVzZXJfZGF0YTogZmFsc2UsXG4gICAgICAgICAgICBzeXN0ZW1fY29uZmlnOiBmYWxzZSxcbiAgICAgICAgICAgIGFuYWx5dGljczogZmFsc2UsXG4gICAgICAgICAgICBmb3JtYXQ6ICd6aXAnLFxuICAgICAgICAgICAgY29tcHJlc3Npb246ICdiYWxhbmNlZCcsXG4gICAgICAgICAgICBzcGxpdF9hcmNoaXZlczogZmFsc2UsXG4gICAgICAgICAgICBtYXhfc2l6ZV9tYjogMTAyNCxcbiAgICAgICAgICAgIGVuY3J5cHQ6IGZhbHNlLFxuICAgICAgICAgICAgcGFzc3dvcmQ6ICcnXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBpbXBvcnRDb25maWc6IHsgXG4gICAgICAgICAgICBtb2RlOiAnbWVyZ2UnLCBcbiAgICAgICAgICAgIGNvbmZsaWN0X3Jlc29sdXRpb246ICdhc2snLCBcbiAgICAgICAgICAgIHZhbGlkYXRlOiB0cnVlLCBcbiAgICAgICAgICAgIGJhY2t1cF9iZWZvcmU6IHRydWUsIFxuICAgICAgICAgICAgcGFzc3dvcmQ6ICcnIFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgaXNFeHBvcnRpbmc6IGZhbHNlLFxuICAgICAgICBpc0ltcG9ydGluZzogZmFsc2UsXG4gICAgICAgIGVzdGltYXRlZFNpemU6ICcwIE1CJyxcbiAgICAgICAgZXN0aW1hdGVkVGltZTogJzAgbWludXRlcycsXG4gICAgICAgIGltcG9ydEZpbGVzOiBbXSxcbiAgICAgICAgaW1wb3J0UHJldmlldzogW10sXG4gICAgICAgIGJhY2t1cEhpc3Rvcnk6IFtdLFxuICAgICAgICBoYXNFbmNyeXB0ZWRGaWxlczogZmFsc2UsXG4gICAgICAgIHNob3dQcm9ncmVzczogZmFsc2UsXG4gICAgICAgIHByb2dyZXNzVGl0bGU6ICcnLFxuICAgICAgICBwcm9ncmVzc1N0ZXA6ICcnLFxuICAgICAgICBwcm9ncmVzc1BlcmNlbnQ6IDAsXG4gICAgICAgIHByb2dyZXNzTWVzc2FnZXM6IFtdLFxuICAgICAgICBcbiAgICAgICAgbWlncmF0aW9uUHJvZ3Jlc3M6IHsgXG4gICAgICAgICAgICBhY3RpdmU6IGZhbHNlLCBcbiAgICAgICAgICAgIGN1cnJlbnRfc3RlcDogJycsIFxuICAgICAgICAgICAgY29tcGxldGVkOiAwLCBcbiAgICAgICAgICAgIHRvdGFsOiAxMDAsIFxuICAgICAgICAgICAgc3RhdHVzOiAnaWRsZScsIFxuICAgICAgICAgICAgbG9nczogW10gXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBpbml0KCkge1xuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgY29tcG9uZW50XG4gICAgICAgICAgICB0aGlzLmxvYWRBdmFpbGFibGVMb3JhcygpO1xuICAgICAgICAgICAgdGhpcy5pc0luaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGFzeW5jIGxvYWRBdmFpbGFibGVMb3JhcygpIHtcbiAgICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IGZldGNoRGF0YSgod2luZG93Py5CQUNLRU5EX1VSTCB8fCAnJykgKyAnL2FkYXB0ZXJzJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5hdmFpbGFibGVMb3JhcyA9IGRhdGEuaXRlbXMgfHwgZGF0YSB8fCBbXTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgLy8gSGFuZGxlIGVycm9yIHNpbGVudGx5IG9yIHVzZSBwcm9wZXIgZXJyb3IgcmVwb3J0aW5nXG4gICAgICAgICAgICAgICAgdGhpcy5zaG93VG9hc3RNZXNzYWdlKCdGYWlsZWQgdG8gbG9hZCBMb1JBcycsICdlcnJvcicpO1xuICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgbG9hZFNlbGVjdGVkTG9yYSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkTG9yYUlkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZExvcmEgPSB0aGlzLmF2YWlsYWJsZUxvcmFzLmZpbmQobG9yYSA9PiBsb3JhLmlkID09PSB0aGlzLnNlbGVjdGVkTG9yYUlkKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVJlY29tbWVuZGF0aW9ucygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHVwZGF0ZVJlY29tbWVuZGF0aW9ucygpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkTG9yYUlkKSB7XG4gICAgICAgICAgICAgICAgLy8gVHJpZ2dlciBzaW1pbGFyaXR5IHNlYXJjaCAocGxhY2Vob2xkZXIpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2VhcmNoQnlQcm9tcHQoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcm9tcHRUZXh0LnRyaW0oKSkge1xuICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgcHJvbXB0LWJhc2VkIHNlYXJjaCAocGxhY2Vob2xkZXIpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVzZXRXZWlnaHRzKCkge1xuICAgICAgICAgICAgdGhpcy53ZWlnaHRzID0ge1xuICAgICAgICAgICAgICAgIHNlbWFudGljOiAwLjYsXG4gICAgICAgICAgICAgICAgYXJ0aXN0aWM6IDAuMyxcbiAgICAgICAgICAgICAgICB0ZWNobmljYWw6IDAuMVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUmVjb21tZW5kYXRpb25zKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYXN5bmMgY29tcHV0ZUFsbEVtYmVkZGluZ3MoKSB7XG4gICAgICAgICAgICB0aGlzLmNvbXB1dGluZ0VtYmVkZGluZ3MgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5lbWJlZGRpbmdQcm9ncmVzcyA9IDA7XG4gICAgICAgICAgICB0aGlzLmVtYmVkZGluZ1N0YXR1cyA9ICdTdGFydGluZyBlbWJlZGRpbmcgY29tcHV0YXRpb24uLi4nO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIFNpbXVsYXRlIHByb2dyZXNzXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gMTAwOyBpICs9IDEwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW1iZWRkaW5nUHJvZ3Jlc3MgPSBpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVtYmVkZGluZ1N0YXR1cyA9IGBDb21wdXRpbmcgZW1iZWRkaW5ncy4uLiAke2l9JWA7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDApKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGhpcy5lbWJlZGRpbmdTdGF0dXMgPSAnRW1iZWRkaW5ncyBjb21wdXRlZCBzdWNjZXNzZnVsbHkhJztcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dUb2FzdE1lc3NhZ2UoJ0VtYmVkZGluZ3MgY29tcHV0ZWQgc3VjY2Vzc2Z1bGx5IScsICdzdWNjZXNzJyk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHRoaXMuZW1iZWRkaW5nU3RhdHVzID0gJ0ZhaWxlZCB0byBjb21wdXRlIGVtYmVkZGluZ3MnO1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1RvYXN0TWVzc2FnZSgnRmFpbGVkIHRvIGNvbXB1dGUgZW1iZWRkaW5ncycsICdlcnJvcicpO1xuICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wdXRpbmdFbWJlZGRpbmdzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSwgMjAwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgYXN5bmMgcmVidWlsZEluZGV4KCkge1xuICAgICAgICAgICAgdGhpcy5yZWJ1aWxkaW5nSW5kZXggPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5lbWJlZGRpbmdQcm9ncmVzcyA9IDA7XG4gICAgICAgICAgICB0aGlzLmVtYmVkZGluZ1N0YXR1cyA9ICdSZWJ1aWxkaW5nIHNpbWlsYXJpdHkgaW5kZXguLi4nO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIFNpbXVsYXRlIHByb2dyZXNzXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gMTAwOyBpICs9IDIwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW1iZWRkaW5nUHJvZ3Jlc3MgPSBpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVtYmVkZGluZ1N0YXR1cyA9IGBSZWJ1aWxkaW5nIGluZGV4Li4uICR7aX0lYDtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDE1MCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0aGlzLmVtYmVkZGluZ1N0YXR1cyA9ICdJbmRleCByZWJ1aWx0IHN1Y2Nlc3NmdWxseSEnO1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1RvYXN0TWVzc2FnZSgnSW5kZXggcmVidWlsdCBzdWNjZXNzZnVsbHkhJywgJ3N1Y2Nlc3MnKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbWJlZGRpbmdTdGF0dXMgPSAnRmFpbGVkIHRvIHJlYnVpbGQgaW5kZXgnO1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1RvYXN0TWVzc2FnZSgnRmFpbGVkIHRvIHJlYnVpbGQgaW5kZXgnLCAnZXJyb3InKTtcbiAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVidWlsZGluZ0luZGV4ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSwgMjAwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgdmlld0hlYWx0aFJlcG9ydCgpIHtcbiAgICAgICAgICAgIHdpbmRvdy5vcGVuKCh3aW5kb3c/LkJBQ0tFTkRfVVJMIHx8ICcnKSArICcvcmVjb21tZW5kYXRpb25zL2hlYWx0aCcsICdfYmxhbmsnKTtcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIHNob3dUb2FzdE1lc3NhZ2UobWVzc2FnZSwgdHlwZSA9ICdzdWNjZXNzJykge1xuICAgICAgICAgICAgdGhpcy50b2FzdE1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgICAgICAgICAgdGhpcy50b2FzdFR5cGUgPSB0eXBlO1xuICAgICAgICAgICAgdGhpcy5zaG93VG9hc3QgPSB0cnVlO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBdXRvLWhpZGUgYWZ0ZXIgMyBzZWNvbmRzXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dUb2FzdCA9IGZhbHNlO1xuICAgICAgICAgICAgfSwgMzAwMCk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsU0FBU0EsU0FBUyxRQUFRLGlCQUFpQjs7QUFFM0M7QUFDQTs7QUFFQSxPQUFPLFNBQVNDLDhCQUE4QkEsQ0FBQSxFQUFHO0VBQzdDO0VBQ0EsSUFBSSxPQUFPQyxNQUFNLEtBQUssV0FBVyxJQUFJQSxNQUFNLENBQUNELDhCQUE4QixFQUFFO0lBQ3hFLE9BQU9DLE1BQU0sQ0FBQ0QsOEJBQThCLENBQUMsQ0FBQztFQUNsRDs7RUFFQTtFQUNBLE9BQU87SUFDSDtJQUNBRSxhQUFhLEVBQUUsS0FBSztJQUVwQkMsU0FBUyxFQUFFLEtBQUs7SUFDaEJDLE9BQU8sRUFBRSxLQUFLO0lBQ2RDLFNBQVMsRUFBRSxLQUFLO0lBQ2hCQyxZQUFZLEVBQUUsRUFBRTtJQUNoQkMsU0FBUyxFQUFFLFNBQVM7SUFFcEI7SUFDQUMsU0FBUyxFQUFFLFlBQVk7SUFFdkI7SUFDQUMsY0FBYyxFQUFFLEVBQUU7SUFFbEI7SUFDQUMsY0FBYyxFQUFFLEVBQUU7SUFDbEJDLFlBQVksRUFBRSxJQUFJO0lBQ2xCQyxPQUFPLEVBQUU7TUFDTEMsUUFBUSxFQUFFLEdBQUc7TUFDYkMsUUFBUSxFQUFFLEdBQUc7TUFDYkMsU0FBUyxFQUFFO0lBQ2YsQ0FBQztJQUNEQyxlQUFlLEVBQUUsRUFBRTtJQUNuQkMsbUJBQW1CLEVBQUUsR0FBRztJQUV4QjtJQUNBQyxVQUFVLEVBQUUsRUFBRTtJQUNkQyxXQUFXLEVBQUUsRUFBRTtJQUNmQyxxQkFBcUIsRUFBRSxLQUFLO0lBQzVCQyxpQkFBaUIsRUFBRSxDQUNmLDJCQUEyQixFQUMzQixnQ0FBZ0MsRUFDaEMsOEJBQThCLEVBQzlCLDRCQUE0QixFQUM1Qix1QkFBdUIs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