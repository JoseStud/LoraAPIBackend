08fb39c61bd196874c20cdc21f500be6
/**
 * PWA Manager - Installation Module
 * 
 * Handles PWA installation prompts, detection, and installation flow.
 */

/**
 * PWA installation management operations
 */
const pwaInstallation = {
  /**
   * Checks if PWA is currently installed
   */
  checkInstallationStatus() {
    // Check various PWA indicators
    const isStandalone = window.matchMedia('(display-mode: standalone)').matches;
    const isNavigatorStandalone = window.navigator.standalone === true;
    const isAndroidApp = document.referrer.includes('android-app://');
    const isIOSStandalone = window.navigator.standalone;
    return {
      isInstalled: isStandalone || isNavigatorStandalone || isAndroidApp || isIOSStandalone,
      standalone: isStandalone,
      navigatorStandalone: isNavigatorStandalone,
      androidApp: isAndroidApp,
      iosStandalone: Boolean(isIOSStandalone)
    };
  },
  /**
   * Sets up installation event listeners
   */
  setupEventListeners(callbacks = {}) {
    let deferredPrompt = null;

    // Handle beforeinstallprompt
    const handleBeforeInstallPrompt = event => {
      event.preventDefault();
      deferredPrompt = event;
      if (callbacks.onInstallPromptAvailable) {
        callbacks.onInstallPromptAvailable(event);
      }
    };

    // Handle app installed
    const handleAppInstalled = event => {
      deferredPrompt = null;
      if (callbacks.onAppInstalled) {
        callbacks.onAppInstalled(event);
      }
    };

    // Handle display mode changes
    const handleDisplayModeChange = event => {
      if (callbacks.onDisplayModeChange) {
        callbacks.onDisplayModeChange(event.matches);
      }
    };
    window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);
    window.addEventListener('appinstalled', handleAppInstalled);

    // Monitor display mode changes
    const standaloneMedia = window.matchMedia('(display-mode: standalone)');
    standaloneMedia.addListener(handleDisplayModeChange);

    // Return cleanup function and current prompt
    return {
      cleanup: () => {
        window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);
        window.removeEventListener('appinstalled', handleAppInstalled);
        standaloneMedia.removeListener(handleDisplayModeChange);
      },
      getDeferredPrompt: () => deferredPrompt,
      setDeferredPrompt: prompt => {
        deferredPrompt = prompt;
      }
    };
  },
  /**
   * Triggers the install prompt
   */
  async triggerInstall(deferredPrompt) {
    if (!deferredPrompt) {
      throw new Error('No deferred install prompt available');
    }
    try {
      const result = await deferredPrompt.prompt();
      if (window.DevLogger?.debug) {
        window.DevLogger.debug('[PWA] Install prompt result:', result);
      }
      return {
        outcome: result.outcome,
        userChoice: result.outcome === 'accepted'
      };
    } catch (error) {
      throw new Error(`Install prompt failed: ${error.message}`);
    }
  },
  /**
   * Checks if installation is supported
   */
  isInstallSupported() {
    // Check for various PWA installation methods
    return {
      beforeInstallPrompt: 'BeforeInstallPromptEvent' in window || 'onbeforeinstallprompt' in window,
      appleWebApp: /iPad|iPhone|iPod/.test(navigator.userAgent),
      androidWebApp: /Android/.test(navigator.userAgent),
      chromeWebApp: 'chrome' in window && 'webstore' in window.chrome,
      edgeWebApp: navigator.userAgent.includes('Edg/'),
      firefoxWebApp: navigator.userAgent.includes('Firefox/')
    };
  },
  /**
   * Gets installation criteria status
   */
  getInstallCriteria() {
    return {
      isHTTPS: location.protocol === 'https:' || location.hostname === 'localhost',
      hasManifest: Boolean(document.querySelector('link[rel="manifest"]')),
      hasServiceWorker: 'serviceWorker' in navigator,
      hasValidManifest: this.validateManifest(),
      isInstallable: this.checkInstallability()
    };
  },
  /**
   * Validates the web app manifest
   */
  async validateManifest() {
    const manifestLink = document.querySelector('link[rel="manifest"]');
    if (!manifestLink) return false;
    try {
      const response = await fetch(manifestLink.href);
      const manifest = await response.json();

      // Check required fields
      const required = ['name', 'short_name', 'start_url', 'display', 'icons'];
      const hasRequired = required.every(field => manifest[field]);

      // Check for valid icon
      const hasValidIcon = manifest.icons && manifest.icons.some(icon => icon.sizes && (icon.sizes.includes('192x192') || icon.sizes.includes('512x512')));
      return {
        valid: hasRequired && hasValidIcon,
        manifest,
        missingFields: required.filter(field => !manifest[field]),
        hasValidIcon
      };
    } catch (error) {
      return {
        valid: false,
        error: error.message
      };
    }
  },
  /**
   * Checks overall installability (non-recursive)
   */
  checkInstallability() {
    // Compute basic criteria directly to avoid recursion with getInstallCriteria
    const isHTTPS = location.protocol === 'https:' || location.hostname === 'localhost';
    const hasManifest = Boolean(document.querySelector && document.querySelector('link[rel="manifest"]'));
    const hasServiceWorker = typeof navigator !== 'undefined' && 'serviceWorker' in navigator;
    return isHTTPS && hasManifest && hasServiceWorker;
  },
  /**
   * Manages install prompt dismissal
   */
  manageInstallDismissal() {
    const STORAGE_KEY = 'pwa-install-dismissed';
    const REMINDER_DAYS = 7;
    return {
      isDismissed() {
        const dismissedTime = localStorage.getItem(STORAGE_KEY);
        if (!dismissedTime) return false;
        const daysSince = (Date.now() - parseInt(dismissedTime)) / (1000 * 60 * 60 * 24);
        return daysSince < REMINDER_DAYS;
      },
      dismiss() {
        localStorage.setItem(STORAGE_KEY, Date.now().toString());
      },
      clearDismissal() {
        localStorage.removeItem(STORAGE_KEY);
      },
      getDismissedTime() {
        const time = localStorage.getItem(STORAGE_KEY);
        return time ? new Date(parseInt(time)) : null;
      },
      getDaysSinceDismissed() {
        const time = localStorage.getItem(STORAGE_KEY);
        if (!time) return null;
        return (Date.now() - parseInt(time)) / (1000 * 60 * 60 * 24);
      }
    };
  },
  /**
   * Creates install prompt UI
   */
  createInstallPrompt(options = {}) {
    const {
      title = 'Install App',
      message = 'Install this app for a better experience?',
      installText = 'Install',
      dismissText = 'Not Now',
      className = 'pwa-install-prompt'
    } = options;
    const prompt = document.createElement('div');
    prompt.id = 'pwa-install-prompt';
    prompt.className = `${className} fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-80 bg-white border border-gray-200 rounded-lg shadow-lg p-4 z-50`;
    prompt.innerHTML = `
            <div class="flex items-start space-x-3">
                <div class="flex-shrink-0">
                    <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"></path>
                        </svg>
                    </div>
                </div>
                <div class="flex-1 min-w-0">
                    <h3 class="text-sm font-semibold text-gray-900">${title}</h3>
                    <p class="text-sm text-gray-600 mt-1">${message}</p>
                    <div class="flex space-x-2 mt-3">
                        <button id="pwa-install-btn" class="btn btn-primary btn-sm">
                            ${installText}
                        </button>
                        <button id="pwa-dismiss-btn" class="btn btn-ghost btn-sm">
                            ${dismissText}
                        </button>
                    </div>
                </div>
                <button id="pwa-close-btn" class="flex-shrink-0 text-gray-400 hover:text-gray-600">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
        `;
    return prompt;
  },
  /**
   * Shows platform-specific install instructions
   */
  showPlatformInstructions() {
    const userAgent = navigator.userAgent;
    let instructions = '';
    if (/iPad|iPhone|iPod/.test(userAgent)) {
      instructions = 'Tap the share button and select "Add to Home Screen"';
    } else if (/Android/.test(userAgent)) {
      instructions = 'Tap the menu button and select "Add to Home Screen" or "Install App"';
    } else if (userAgent.includes('Chrome')) {
      instructions = 'Click the install button in the address bar or menu';
    } else if (userAgent.includes('Firefox')) {
      instructions = 'This app can be installed from supported browsers like Chrome or Edge';
    } else if (userAgent.includes('Safari')) {
      instructions = 'Use the share menu and select "Add to Home Screen"';
    } else {
      instructions = 'Use a supported browser like Chrome, Firefox, or Safari to install this app';
    }
    return {
      platform: this.detectPlatform(),
      instructions,
      canInstall: this.isInstallSupported()
    };
  },
  /**
   * Detects the user's platform
   */
  detectPlatform() {
    const userAgent = navigator.userAgent;
    if (/iPad|iPhone|iPod/.test(userAgent)) return 'ios';
    if (/Android/.test(userAgent)) return 'android';
    if (/Windows/.test(userAgent)) return 'windows';
    if (/Mac/.test(userAgent)) return 'mac';
    if (/Linux/.test(userAgent)) return 'linux';
    return 'unknown';
  },
  /**
   * Gets installation analytics data
   */
  getInstallationAnalytics() {
    const installStatus = this.checkInstallationStatus();
    const criteria = this.getInstallCriteria();
    const support = this.isInstallSupported();
    const dismissal = this.manageInstallDismissal();
    return {
      isInstalled: installStatus.isInstalled,
      isInstallable: this.checkInstallability(),
      platform: this.detectPlatform(),
      supportLevel: Object.values(support).filter(Boolean).length,
      criteriaStatus: criteria,
      dismissalStatus: {
        isDismissed: dismissal.isDismissed(),
        daysSinceDismissed: dismissal.getDaysSinceDismissed()
      },
      userAgent: navigator.userAgent,
      timestamp: Date.now()
    };
  }
};

// Export for use in other modules
if (typeof module !== 'undefined' && module.exports) {
  module.exports = {
    pwaInstallation
  };
} else if (typeof window !== 'undefined') {
  window.pwaInstallation = pwaInstallation;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJwd2FJbnN0YWxsYXRpb24iLCJjaGVja0luc3RhbGxhdGlvblN0YXR1cyIsImlzU3RhbmRhbG9uZSIsIndpbmRvdyIsIm1hdGNoTWVkaWEiLCJtYXRjaGVzIiwiaXNOYXZpZ2F0b3JTdGFuZGFsb25lIiwibmF2aWdhdG9yIiwic3RhbmRhbG9uZSIsImlzQW5kcm9pZEFwcCIsImRvY3VtZW50IiwicmVmZXJyZXIiLCJpbmNsdWRlcyIsImlzSU9TU3RhbmRhbG9uZSIsImlzSW5zdGFsbGVkIiwibmF2aWdhdG9yU3RhbmRhbG9uZSIsImFuZHJvaWRBcHAiLCJpb3NTdGFuZGFsb25lIiwiQm9vbGVhbiIsInNldHVwRXZlbnRMaXN0ZW5lcnMiLCJjYWxsYmFja3MiLCJkZWZlcnJlZFByb21wdCIsImhhbmRsZUJlZm9yZUluc3RhbGxQcm9tcHQiLCJldmVudCIsInByZXZlbnREZWZhdWx0Iiwib25JbnN0YWxsUHJvbXB0QXZhaWxhYmxlIiwiaGFuZGxlQXBwSW5zdGFsbGVkIiwib25BcHBJbnN0YWxsZWQiLCJoYW5kbGVEaXNwbGF5TW9kZUNoYW5nZSIsIm9uRGlzcGxheU1vZGVDaGFuZ2UiLCJhZGRFdmVudExpc3RlbmVyIiwic3RhbmRhbG9uZU1lZGlhIiwiYWRkTGlzdGVuZXIiLCJjbGVhbnVwIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInJlbW92ZUxpc3RlbmVyIiwiZ2V0RGVmZXJyZWRQcm9tcHQiLCJzZXREZWZlcnJlZFByb21wdCIsInByb21wdCIsInRyaWdnZXJJbnN0YWxsIiwiRXJyb3IiLCJyZXN1bHQiLCJEZXZMb2dnZXIiLCJkZWJ1ZyIsIm91dGNvbWUiLCJ1c2VyQ2hvaWNlIiwiZXJyb3IiLCJtZXNzYWdlIiwiaXNJbnN0YWxsU3VwcG9ydGVkIiwiYmVmb3JlSW5zdGFsbFByb21wdCIsImFwcGxlV2ViQXBwIiwidGVzdCIsInVzZXJBZ2VudCIsImFuZHJvaWRXZWJBcHAiLCJjaHJvbWVXZWJBcHAiLCJjaHJvbWUiLCJlZGdlV2ViQXBwIiwiZmlyZWZveFdlYkFwcCIsImdldEluc3RhbGxDcml0ZXJpYSIsImlzSFRUUFMiLCJsb2NhdGlvbiIsInByb3RvY29sIiwiaG9zdG5hbWUiLCJoYXNNYW5pZmVzdCIsInF1ZXJ5U2VsZWN0b3IiLCJoYXNTZXJ2aWNlV29ya2VyIiwiaGFzVmFsaWRNYW5pZmVzdCIsInZhbGlkYXRlTWFuaWZlc3QiLCJpc0luc3RhbGxhYmxlIiwiY2hlY2tJbnN0YWxsYWJpbGl0eSIsIm1hbmlmZXN0TGluayIsInJlc3BvbnNlIiwiZmV0Y2giLCJocmVmIiwibWFuaWZlc3QiLCJqc29uIiwicmVxdWlyZWQiLCJoYXNSZXF1aXJlZCIsImV2ZXJ5IiwiZmllbGQiLCJoYXNWYWxpZEljb24iLCJpY29ucyIsInNvbWUiLCJpY29uIiwic2l6ZXMiLCJ2YWxpZCIsIm1pc3NpbmdGaWVsZHMiLCJmaWx0ZXIiLCJtYW5hZ2VJbnN0YWxsRGlzbWlzc2FsIiwiU1RPUkFHRV9LRVkiLCJSRU1JTkRFUl9EQVlTIiwiaXNEaXNtaXNzZWQiLCJkaXNtaXNzZWRUaW1lIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImRheXNTaW5jZSIsIkRhdGUiLCJub3ciLCJwYXJzZUludCIsImRpc21pc3MiLCJzZXRJdGVtIiwidG9TdHJpbmciLCJjbGVhckRpc21pc3NhbCIsInJlbW92ZUl0ZW0iLCJnZXREaXNtaXNzZWRUaW1lIiwidGltZSIsImdldERheXNTaW5jZURpc21pc3NlZCIsImNyZWF0ZUluc3RhbGxQcm9tcHQiLCJvcHRpb25zIiwidGl0bGUiLCJpbnN0YWxsVGV4dCIsImRpc21pc3NUZXh0IiwiY2xhc3NOYW1lIiwiY3JlYXRlRWxlbWVudCIsImlkIiwiaW5uZXJIVE1MIiwic2hvd1BsYXRmb3JtSW5zdHJ1Y3Rpb25zIiwiaW5zdHJ1Y3Rpb25zIiwicGxhdGZvcm0iLCJkZXRlY3RQbGF0Zm9ybSIsImNhbkluc3RhbGwiLCJnZXRJbnN0YWxsYXRpb25BbmFseXRpY3MiLCJpbnN0YWxsU3RhdHVzIiwiY3JpdGVyaWEiLCJzdXBwb3J0IiwiZGlzbWlzc2FsIiwic3VwcG9ydExldmVsIiwiT2JqZWN0IiwidmFsdWVzIiwibGVuZ3RoIiwiY3JpdGVyaWFTdGF0dXMiLCJkaXNtaXNzYWxTdGF0dXMiLCJkYXlzU2luY2VEaXNtaXNzZWQiLCJ0aW1lc3RhbXAiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiaW5zdGFsbGF0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUFdBIE1hbmFnZXIgLSBJbnN0YWxsYXRpb24gTW9kdWxlXG4gKiBcbiAqIEhhbmRsZXMgUFdBIGluc3RhbGxhdGlvbiBwcm9tcHRzLCBkZXRlY3Rpb24sIGFuZCBpbnN0YWxsYXRpb24gZmxvdy5cbiAqL1xuXG4vKipcbiAqIFBXQSBpbnN0YWxsYXRpb24gbWFuYWdlbWVudCBvcGVyYXRpb25zXG4gKi9cbmNvbnN0IHB3YUluc3RhbGxhdGlvbiA9IHtcbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgUFdBIGlzIGN1cnJlbnRseSBpbnN0YWxsZWRcbiAgICAgKi9cbiAgICBjaGVja0luc3RhbGxhdGlvblN0YXR1cygpIHtcbiAgICAgICAgLy8gQ2hlY2sgdmFyaW91cyBQV0EgaW5kaWNhdG9yc1xuICAgICAgICBjb25zdCBpc1N0YW5kYWxvbmUgPSB3aW5kb3cubWF0Y2hNZWRpYSgnKGRpc3BsYXktbW9kZTogc3RhbmRhbG9uZSknKS5tYXRjaGVzO1xuICAgICAgICBjb25zdCBpc05hdmlnYXRvclN0YW5kYWxvbmUgPSB3aW5kb3cubmF2aWdhdG9yLnN0YW5kYWxvbmUgPT09IHRydWU7XG4gICAgICAgIGNvbnN0IGlzQW5kcm9pZEFwcCA9IGRvY3VtZW50LnJlZmVycmVyLmluY2x1ZGVzKCdhbmRyb2lkLWFwcDovLycpO1xuICAgICAgICBjb25zdCBpc0lPU1N0YW5kYWxvbmUgPSB3aW5kb3cubmF2aWdhdG9yLnN0YW5kYWxvbmU7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaXNJbnN0YWxsZWQ6IGlzU3RhbmRhbG9uZSB8fCBpc05hdmlnYXRvclN0YW5kYWxvbmUgfHwgaXNBbmRyb2lkQXBwIHx8IGlzSU9TU3RhbmRhbG9uZSxcbiAgICAgICAgICAgIHN0YW5kYWxvbmU6IGlzU3RhbmRhbG9uZSxcbiAgICAgICAgICAgIG5hdmlnYXRvclN0YW5kYWxvbmU6IGlzTmF2aWdhdG9yU3RhbmRhbG9uZSxcbiAgICAgICAgICAgIGFuZHJvaWRBcHA6IGlzQW5kcm9pZEFwcCxcbiAgICAgICAgICAgIGlvc1N0YW5kYWxvbmU6IEJvb2xlYW4oaXNJT1NTdGFuZGFsb25lKVxuICAgICAgICB9O1xuICAgIH0sXG4gICAgXG4gICAgLyoqXG4gICAgICogU2V0cyB1cCBpbnN0YWxsYXRpb24gZXZlbnQgbGlzdGVuZXJzXG4gICAgICovXG4gICAgc2V0dXBFdmVudExpc3RlbmVycyhjYWxsYmFja3MgPSB7fSkge1xuICAgICAgICBsZXQgZGVmZXJyZWRQcm9tcHQgPSBudWxsO1xuICAgICAgICBcbiAgICAgICAgLy8gSGFuZGxlIGJlZm9yZWluc3RhbGxwcm9tcHRcbiAgICAgICAgY29uc3QgaGFuZGxlQmVmb3JlSW5zdGFsbFByb21wdCA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGRlZmVycmVkUHJvbXB0ID0gZXZlbnQ7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChjYWxsYmFja3Mub25JbnN0YWxsUHJvbXB0QXZhaWxhYmxlKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2tzLm9uSW5zdGFsbFByb21wdEF2YWlsYWJsZShldmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICAvLyBIYW5kbGUgYXBwIGluc3RhbGxlZFxuICAgICAgICBjb25zdCBoYW5kbGVBcHBJbnN0YWxsZWQgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGRlZmVycmVkUHJvbXB0ID0gbnVsbDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrcy5vbkFwcEluc3RhbGxlZCkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrcy5vbkFwcEluc3RhbGxlZChldmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICAvLyBIYW5kbGUgZGlzcGxheSBtb2RlIGNoYW5nZXNcbiAgICAgICAgY29uc3QgaGFuZGxlRGlzcGxheU1vZGVDaGFuZ2UgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmIChjYWxsYmFja3Mub25EaXNwbGF5TW9kZUNoYW5nZSkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrcy5vbkRpc3BsYXlNb2RlQ2hhbmdlKGV2ZW50Lm1hdGNoZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZWluc3RhbGxwcm9tcHQnLCBoYW5kbGVCZWZvcmVJbnN0YWxsUHJvbXB0KTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2FwcGluc3RhbGxlZCcsIGhhbmRsZUFwcEluc3RhbGxlZCk7XG4gICAgICAgIFxuICAgICAgICAvLyBNb25pdG9yIGRpc3BsYXkgbW9kZSBjaGFuZ2VzXG4gICAgICAgIGNvbnN0IHN0YW5kYWxvbmVNZWRpYSA9IHdpbmRvdy5tYXRjaE1lZGlhKCcoZGlzcGxheS1tb2RlOiBzdGFuZGFsb25lKScpO1xuICAgICAgICBzdGFuZGFsb25lTWVkaWEuYWRkTGlzdGVuZXIoaGFuZGxlRGlzcGxheU1vZGVDaGFuZ2UpO1xuICAgICAgICBcbiAgICAgICAgLy8gUmV0dXJuIGNsZWFudXAgZnVuY3Rpb24gYW5kIGN1cnJlbnQgcHJvbXB0XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjbGVhbnVwOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JlZm9yZWluc3RhbGxwcm9tcHQnLCBoYW5kbGVCZWZvcmVJbnN0YWxsUHJvbXB0KTtcbiAgICAgICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignYXBwaW5zdGFsbGVkJywgaGFuZGxlQXBwSW5zdGFsbGVkKTtcbiAgICAgICAgICAgICAgICBzdGFuZGFsb25lTWVkaWEucmVtb3ZlTGlzdGVuZXIoaGFuZGxlRGlzcGxheU1vZGVDaGFuZ2UpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldERlZmVycmVkUHJvbXB0OiAoKSA9PiBkZWZlcnJlZFByb21wdCxcbiAgICAgICAgICAgIHNldERlZmVycmVkUHJvbXB0OiAocHJvbXB0KSA9PiB7IGRlZmVycmVkUHJvbXB0ID0gcHJvbXB0OyB9XG4gICAgICAgIH07XG4gICAgfSxcbiAgICBcbiAgICAvKipcbiAgICAgKiBUcmlnZ2VycyB0aGUgaW5zdGFsbCBwcm9tcHRcbiAgICAgKi9cbiAgICBhc3luYyB0cmlnZ2VySW5zdGFsbChkZWZlcnJlZFByb21wdCkge1xuICAgICAgICBpZiAoIWRlZmVycmVkUHJvbXB0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGRlZmVycmVkIGluc3RhbGwgcHJvbXB0IGF2YWlsYWJsZScpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGVmZXJyZWRQcm9tcHQucHJvbXB0KCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICh3aW5kb3cuRGV2TG9nZ2VyPy5kZWJ1Zykge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5EZXZMb2dnZXIuZGVidWcoJ1tQV0FdIEluc3RhbGwgcHJvbXB0IHJlc3VsdDonLCByZXN1bHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG91dGNvbWU6IHJlc3VsdC5vdXRjb21lLFxuICAgICAgICAgICAgICAgIHVzZXJDaG9pY2U6IHJlc3VsdC5vdXRjb21lID09PSAnYWNjZXB0ZWQnXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluc3RhbGwgcHJvbXB0IGZhaWxlZDogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBcbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgaW5zdGFsbGF0aW9uIGlzIHN1cHBvcnRlZFxuICAgICAqL1xuICAgIGlzSW5zdGFsbFN1cHBvcnRlZCgpIHtcbiAgICAgICAgLy8gQ2hlY2sgZm9yIHZhcmlvdXMgUFdBIGluc3RhbGxhdGlvbiBtZXRob2RzXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBiZWZvcmVJbnN0YWxsUHJvbXB0OiAnQmVmb3JlSW5zdGFsbFByb21wdEV2ZW50JyBpbiB3aW5kb3cgfHwgJ29uYmVmb3JlaW5zdGFsbHByb21wdCcgaW4gd2luZG93LFxuICAgICAgICAgICAgYXBwbGVXZWJBcHA6IC9pUGFkfGlQaG9uZXxpUG9kLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpLFxuICAgICAgICAgICAgYW5kcm9pZFdlYkFwcDogL0FuZHJvaWQvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCksXG4gICAgICAgICAgICBjaHJvbWVXZWJBcHA6ICdjaHJvbWUnIGluIHdpbmRvdyAmJiAnd2Vic3RvcmUnIGluIHdpbmRvdy5jaHJvbWUsXG4gICAgICAgICAgICBlZGdlV2ViQXBwOiBuYXZpZ2F0b3IudXNlckFnZW50LmluY2x1ZGVzKCdFZGcvJyksXG4gICAgICAgICAgICBmaXJlZm94V2ViQXBwOiBuYXZpZ2F0b3IudXNlckFnZW50LmluY2x1ZGVzKCdGaXJlZm94LycpXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBcbiAgICAvKipcbiAgICAgKiBHZXRzIGluc3RhbGxhdGlvbiBjcml0ZXJpYSBzdGF0dXNcbiAgICAgKi9cbiAgICBnZXRJbnN0YWxsQ3JpdGVyaWEoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpc0hUVFBTOiBsb2NhdGlvbi5wcm90b2NvbCA9PT0gJ2h0dHBzOicgfHwgbG9jYXRpb24uaG9zdG5hbWUgPT09ICdsb2NhbGhvc3QnLFxuICAgICAgICAgICAgaGFzTWFuaWZlc3Q6IEJvb2xlYW4oZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbGlua1tyZWw9XCJtYW5pZmVzdFwiXScpKSxcbiAgICAgICAgICAgIGhhc1NlcnZpY2VXb3JrZXI6ICdzZXJ2aWNlV29ya2VyJyBpbiBuYXZpZ2F0b3IsXG4gICAgICAgICAgICBoYXNWYWxpZE1hbmlmZXN0OiB0aGlzLnZhbGlkYXRlTWFuaWZlc3QoKSxcbiAgICAgICAgICAgIGlzSW5zdGFsbGFibGU6IHRoaXMuY2hlY2tJbnN0YWxsYWJpbGl0eSgpXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBcbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZXMgdGhlIHdlYiBhcHAgbWFuaWZlc3RcbiAgICAgKi9cbiAgICBhc3luYyB2YWxpZGF0ZU1hbmlmZXN0KCkge1xuICAgICAgICBjb25zdCBtYW5pZmVzdExpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdsaW5rW3JlbD1cIm1hbmlmZXN0XCJdJyk7XG4gICAgICAgIGlmICghbWFuaWZlc3RMaW5rKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChtYW5pZmVzdExpbmsuaHJlZik7XG4gICAgICAgICAgICBjb25zdCBtYW5pZmVzdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ2hlY2sgcmVxdWlyZWQgZmllbGRzXG4gICAgICAgICAgICBjb25zdCByZXF1aXJlZCA9IFsnbmFtZScsICdzaG9ydF9uYW1lJywgJ3N0YXJ0X3VybCcsICdkaXNwbGF5JywgJ2ljb25zJ107XG4gICAgICAgICAgICBjb25zdCBoYXNSZXF1aXJlZCA9IHJlcXVpcmVkLmV2ZXJ5KGZpZWxkID0+IG1hbmlmZXN0W2ZpZWxkXSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENoZWNrIGZvciB2YWxpZCBpY29uXG4gICAgICAgICAgICBjb25zdCBoYXNWYWxpZEljb24gPSBtYW5pZmVzdC5pY29ucyAmJiBtYW5pZmVzdC5pY29ucy5zb21lKGljb24gPT4gXG4gICAgICAgICAgICAgICAgaWNvbi5zaXplcyAmJiAoaWNvbi5zaXplcy5pbmNsdWRlcygnMTkyeDE5MicpIHx8IGljb24uc2l6ZXMuaW5jbHVkZXMoJzUxMng1MTInKSlcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGhhc1JlcXVpcmVkICYmIGhhc1ZhbGlkSWNvbixcbiAgICAgICAgICAgICAgICBtYW5pZmVzdCxcbiAgICAgICAgICAgICAgICBtaXNzaW5nRmllbGRzOiByZXF1aXJlZC5maWx0ZXIoZmllbGQgPT4gIW1hbmlmZXN0W2ZpZWxkXSksXG4gICAgICAgICAgICAgICAgaGFzVmFsaWRJY29uXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4geyB2YWxpZDogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XG4gICAgICAgIH1cbiAgICB9LFxuICAgIFxuICAgIC8qKlxuICAgICAqIENoZWNrcyBvdmVyYWxsIGluc3RhbGxhYmlsaXR5IChub24tcmVjdXJzaXZlKVxuICAgICAqL1xuICAgIGNoZWNrSW5zdGFsbGFiaWxpdHkoKSB7XG4gICAgICAgIC8vIENvbXB1dGUgYmFzaWMgY3JpdGVyaWEgZGlyZWN0bHkgdG8gYXZvaWQgcmVjdXJzaW9uIHdpdGggZ2V0SW5zdGFsbENyaXRlcmlhXG4gICAgICAgIGNvbnN0IGlzSFRUUFMgPSBsb2NhdGlvbi5wcm90b2NvbCA9PT0gJ2h0dHBzOicgfHwgbG9jYXRpb24uaG9zdG5hbWUgPT09ICdsb2NhbGhvc3QnO1xuICAgICAgICBjb25zdCBoYXNNYW5pZmVzdCA9IEJvb2xlYW4oZG9jdW1lbnQucXVlcnlTZWxlY3RvciAmJiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdsaW5rW3JlbD1cIm1hbmlmZXN0XCJdJykpO1xuICAgICAgICBjb25zdCBoYXNTZXJ2aWNlV29ya2VyID0gdHlwZW9mIG5hdmlnYXRvciAhPT0gJ3VuZGVmaW5lZCcgJiYgJ3NlcnZpY2VXb3JrZXInIGluIG5hdmlnYXRvcjtcblxuICAgICAgICByZXR1cm4gaXNIVFRQUyAmJiBoYXNNYW5pZmVzdCAmJiBoYXNTZXJ2aWNlV29ya2VyO1xuICAgIH0sXG4gICAgXG4gICAgLyoqXG4gICAgICogTWFuYWdlcyBpbnN0YWxsIHByb21wdCBkaXNtaXNzYWxcbiAgICAgKi9cbiAgICBtYW5hZ2VJbnN0YWxsRGlzbWlzc2FsKCkge1xuICAgICAgICBjb25zdCBTVE9SQUdFX0tFWSA9ICdwd2EtaW5zdGFsbC1kaXNtaXNzZWQnO1xuICAgICAgICBjb25zdCBSRU1JTkRFUl9EQVlTID0gNztcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpc0Rpc21pc3NlZCgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkaXNtaXNzZWRUaW1lID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oU1RPUkFHRV9LRVkpO1xuICAgICAgICAgICAgICAgIGlmICghZGlzbWlzc2VkVGltZSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IGRheXNTaW5jZSA9IChEYXRlLm5vdygpIC0gcGFyc2VJbnQoZGlzbWlzc2VkVGltZSkpIC8gKDEwMDAgKiA2MCAqIDYwICogMjQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXlzU2luY2UgPCBSRU1JTkRFUl9EQVlTO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZGlzbWlzcygpIHtcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShTVE9SQUdFX0tFWSwgRGF0ZS5ub3coKS50b1N0cmluZygpKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNsZWFyRGlzbWlzc2FsKCkge1xuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFNUT1JBR0VfS0VZKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGdldERpc21pc3NlZFRpbWUoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGltZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFNUT1JBR0VfS0VZKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGltZSA/IG5ldyBEYXRlKHBhcnNlSW50KHRpbWUpKSA6IG51bGw7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBnZXREYXlzU2luY2VEaXNtaXNzZWQoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGltZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFNUT1JBR0VfS0VZKTtcbiAgICAgICAgICAgICAgICBpZiAoIXRpbWUpIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiAoRGF0ZS5ub3coKSAtIHBhcnNlSW50KHRpbWUpKSAvICgxMDAwICogNjAgKiA2MCAqIDI0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9LFxuICAgIFxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgaW5zdGFsbCBwcm9tcHQgVUlcbiAgICAgKi9cbiAgICBjcmVhdGVJbnN0YWxsUHJvbXB0KG9wdGlvbnMgPSB7fSkge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICB0aXRsZSA9ICdJbnN0YWxsIEFwcCcsXG4gICAgICAgICAgICBtZXNzYWdlID0gJ0luc3RhbGwgdGhpcyBhcHAgZm9yIGEgYmV0dGVyIGV4cGVyaWVuY2U/JyxcbiAgICAgICAgICAgIGluc3RhbGxUZXh0ID0gJ0luc3RhbGwnLFxuICAgICAgICAgICAgZGlzbWlzc1RleHQgPSAnTm90IE5vdycsXG4gICAgICAgICAgICBjbGFzc05hbWUgPSAncHdhLWluc3RhbGwtcHJvbXB0J1xuICAgICAgICB9ID0gb3B0aW9ucztcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHByb21wdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBwcm9tcHQuaWQgPSAncHdhLWluc3RhbGwtcHJvbXB0JztcbiAgICAgICAgcHJvbXB0LmNsYXNzTmFtZSA9IGAke2NsYXNzTmFtZX0gZml4ZWQgYm90dG9tLTQgbGVmdC00IHJpZ2h0LTQgbWQ6bGVmdC1hdXRvIG1kOnJpZ2h0LTQgbWQ6dy04MCBiZy13aGl0ZSBib3JkZXIgYm9yZGVyLWdyYXktMjAwIHJvdW5kZWQtbGcgc2hhZG93LWxnIHAtNCB6LTUwYDtcbiAgICAgICAgXG4gICAgICAgIHByb21wdC5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZmxleCBpdGVtcy1zdGFydCBzcGFjZS14LTNcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZmxleC1zaHJpbmstMFwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidy0xMCBoLTEwIGJnLWJsdWUtMTAwIHJvdW5kZWQtbGcgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgY2xhc3M9XCJ3LTYgaC02IHRleHQtYmx1ZS02MDBcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIiBzdHJva2Utd2lkdGg9XCIyXCIgZD1cIk03IDE2YTQgNCAwIDAxLS44OC03LjkwM0E1IDUgMCAxMTE1LjkgNkwxNiA2YTUgNSAwIDAxMSA5LjlNOSAxOWwzIDNtMCAwbDMtM20tMyAzVjEwXCI+PC9wYXRoPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zdmc+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJmbGV4LTEgbWluLXctMFwiPlxuICAgICAgICAgICAgICAgICAgICA8aDMgY2xhc3M9XCJ0ZXh0LXNtIGZvbnQtc2VtaWJvbGQgdGV4dC1ncmF5LTkwMFwiPiR7dGl0bGV9PC9oMz5cbiAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3M9XCJ0ZXh0LXNtIHRleHQtZ3JheS02MDAgbXQtMVwiPiR7bWVzc2FnZX08L3A+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJmbGV4IHNwYWNlLXgtMiBtdC0zXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPVwicHdhLWluc3RhbGwtYnRuXCIgY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgYnRuLXNtXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtpbnN0YWxsVGV4dH1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD1cInB3YS1kaXNtaXNzLWJ0blwiIGNsYXNzPVwiYnRuIGJ0bi1naG9zdCBidG4tc21cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2Rpc21pc3NUZXh0fVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9XCJwd2EtY2xvc2UtYnRuXCIgY2xhc3M9XCJmbGV4LXNocmluay0wIHRleHQtZ3JheS00MDAgaG92ZXI6dGV4dC1ncmF5LTYwMFwiPlxuICAgICAgICAgICAgICAgICAgICA8c3ZnIGNsYXNzPVwidy01IGgtNVwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIGQ9XCJNNiAxOEwxOCA2TTYgNmwxMiAxMlwiPjwvcGF0aD5cbiAgICAgICAgICAgICAgICAgICAgPC9zdmc+XG4gICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBwcm9tcHQ7XG4gICAgfSxcbiAgICBcbiAgICAvKipcbiAgICAgKiBTaG93cyBwbGF0Zm9ybS1zcGVjaWZpYyBpbnN0YWxsIGluc3RydWN0aW9uc1xuICAgICAqL1xuICAgIHNob3dQbGF0Zm9ybUluc3RydWN0aW9ucygpIHtcbiAgICAgICAgY29uc3QgdXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudDtcbiAgICAgICAgbGV0IGluc3RydWN0aW9ucyA9ICcnO1xuICAgICAgICBcbiAgICAgICAgaWYgKC9pUGFkfGlQaG9uZXxpUG9kLy50ZXN0KHVzZXJBZ2VudCkpIHtcbiAgICAgICAgICAgIGluc3RydWN0aW9ucyA9ICdUYXAgdGhlIHNoYXJlIGJ1dHRvbiBhbmQgc2VsZWN0IFwiQWRkIHRvIEhvbWUgU2NyZWVuXCInO1xuICAgICAgICB9IGVsc2UgaWYgKC9BbmRyb2lkLy50ZXN0KHVzZXJBZ2VudCkpIHtcbiAgICAgICAgICAgIGluc3RydWN0aW9ucyA9ICdUYXAgdGhlIG1lbnUgYnV0dG9uIGFuZCBzZWxlY3QgXCJBZGQgdG8gSG9tZSBTY3JlZW5cIiBvciBcIkluc3RhbGwgQXBwXCInO1xuICAgICAgICB9IGVsc2UgaWYgKHVzZXJBZ2VudC5pbmNsdWRlcygnQ2hyb21lJykpIHtcbiAgICAgICAgICAgIGluc3RydWN0aW9ucyA9ICdDbGljayB0aGUgaW5zdGFsbCBidXR0b24gaW4gdGhlIGFkZHJlc3MgYmFyIG9yIG1lbnUnO1xuICAgICAgICB9IGVsc2UgaWYgKHVzZXJBZ2VudC5pbmNsdWRlcygnRmlyZWZveCcpKSB7XG4gICAgICAgICAgICBpbnN0cnVjdGlvbnMgPSAnVGhpcyBhcHAgY2FuIGJlIGluc3RhbGxlZCBmcm9tIHN1cHBvcnRlZCBicm93c2VycyBsaWtlIENocm9tZSBvciBFZGdlJztcbiAgICAgICAgfSBlbHNlIGlmICh1c2VyQWdlbnQuaW5jbHVkZXMoJ1NhZmFyaScpKSB7XG4gICAgICAgICAgICBpbnN0cnVjdGlvbnMgPSAnVXNlIHRoZSBzaGFyZSBtZW51IGFuZCBzZWxlY3QgXCJBZGQgdG8gSG9tZSBTY3JlZW5cIic7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbnN0cnVjdGlvbnMgPSAnVXNlIGEgc3VwcG9ydGVkIGJyb3dzZXIgbGlrZSBDaHJvbWUsIEZpcmVmb3gsIG9yIFNhZmFyaSB0byBpbnN0YWxsIHRoaXMgYXBwJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHBsYXRmb3JtOiB0aGlzLmRldGVjdFBsYXRmb3JtKCksXG4gICAgICAgICAgICBpbnN0cnVjdGlvbnMsXG4gICAgICAgICAgICBjYW5JbnN0YWxsOiB0aGlzLmlzSW5zdGFsbFN1cHBvcnRlZCgpXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBcbiAgICAvKipcbiAgICAgKiBEZXRlY3RzIHRoZSB1c2VyJ3MgcGxhdGZvcm1cbiAgICAgKi9cbiAgICBkZXRlY3RQbGF0Zm9ybSgpIHtcbiAgICAgICAgY29uc3QgdXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudDtcbiAgICAgICAgXG4gICAgICAgIGlmICgvaVBhZHxpUGhvbmV8aVBvZC8udGVzdCh1c2VyQWdlbnQpKSByZXR1cm4gJ2lvcyc7XG4gICAgICAgIGlmICgvQW5kcm9pZC8udGVzdCh1c2VyQWdlbnQpKSByZXR1cm4gJ2FuZHJvaWQnO1xuICAgICAgICBpZiAoL1dpbmRvd3MvLnRlc3QodXNlckFnZW50KSkgcmV0dXJuICd3aW5kb3dzJztcbiAgICAgICAgaWYgKC9NYWMvLnRlc3QodXNlckFnZW50KSkgcmV0dXJuICdtYWMnO1xuICAgICAgICBpZiAoL0xpbnV4Ly50ZXN0KHVzZXJBZ2VudCkpIHJldHVybiAnbGludXgnO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuICd1bmtub3duJztcbiAgICB9LFxuICAgIFxuICAgIC8qKlxuICAgICAqIEdldHMgaW5zdGFsbGF0aW9uIGFuYWx5dGljcyBkYXRhXG4gICAgICovXG4gICAgZ2V0SW5zdGFsbGF0aW9uQW5hbHl0aWNzKCkge1xuICAgICAgICBjb25zdCBpbnN0YWxsU3RhdHVzID0gdGhpcy5jaGVja0luc3RhbGxhdGlvblN0YXR1cygpO1xuICAgICAgICBjb25zdCBjcml0ZXJpYSA9IHRoaXMuZ2V0SW5zdGFsbENyaXRlcmlhKCk7XG4gICAgICAgIGNvbnN0IHN1cHBvcnQgPSB0aGlzLmlzSW5zdGFsbFN1cHBvcnRlZCgpO1xuICAgICAgICBjb25zdCBkaXNtaXNzYWwgPSB0aGlzLm1hbmFnZUluc3RhbGxEaXNtaXNzYWwoKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpc0luc3RhbGxlZDogaW5zdGFsbFN0YXR1cy5pc0luc3RhbGxlZCxcbiAgICAgICAgICAgIGlzSW5zdGFsbGFibGU6IHRoaXMuY2hlY2tJbnN0YWxsYWJpbGl0eSgpLFxuICAgICAgICAgICAgcGxhdGZvcm06IHRoaXMuZGV0ZWN0UGxhdGZvcm0oKSxcbiAgICAgICAgICAgIHN1cHBvcnRMZXZlbDogT2JqZWN0LnZhbHVlcyhzdXBwb3J0KS5maWx0ZXIoQm9vbGVhbikubGVuZ3RoLFxuICAgICAgICAgICAgY3JpdGVyaWFTdGF0dXM6IGNyaXRlcmlhLFxuICAgICAgICAgICAgZGlzbWlzc2FsU3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgaXNEaXNtaXNzZWQ6IGRpc21pc3NhbC5pc0Rpc21pc3NlZCgpLFxuICAgICAgICAgICAgICAgIGRheXNTaW5jZURpc21pc3NlZDogZGlzbWlzc2FsLmdldERheXNTaW5jZURpc21pc3NlZCgpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdXNlckFnZW50OiBuYXZpZ2F0b3IudXNlckFnZW50LFxuICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXG4gICAgICAgIH07XG4gICAgfVxufTtcblxuLy8gRXhwb3J0IGZvciB1c2UgaW4gb3RoZXIgbW9kdWxlc1xuaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSB7IHB3YUluc3RhbGxhdGlvbiB9O1xufSBlbHNlIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgIHdpbmRvdy5wd2FJbnN0YWxsYXRpb24gPSBwd2FJbnN0YWxsYXRpb247XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTUEsZUFBZSxHQUFHO0VBQ3BCO0FBQ0o7QUFDQTtFQUNJQyx1QkFBdUJBLENBQUEsRUFBRztJQUN0QjtJQUNBLE1BQU1DLFlBQVksR0FBR0MsTUFBTSxDQUFDQyxVQUFVLENBQUMsNEJBQTRCLENBQUMsQ0FBQ0MsT0FBTztJQUM1RSxNQUFNQyxxQkFBcUIsR0FBR0gsTUFBTSxDQUFDSSxTQUFTLENBQUNDLFVBQVUsS0FBSyxJQUFJO0lBQ2xFLE1BQU1DLFlBQVksR0FBR0MsUUFBUSxDQUFDQyxRQUFRLENBQUNDLFFBQVEsQ0FBQyxnQkFBZ0Is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