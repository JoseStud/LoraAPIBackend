1b4f38b607d7a220b11807136a88fc6e
/**
 * API Mocks for Integration Tests
 * Provides realistic mock responses for all API endpoints
 */

// Mock fetch globally for all tests
global.fetch = jest.fn();

// Mock WebSocket
global.WebSocket = jest.fn().mockImplementation(url => {
  return {
    close: jest.fn(),
    send: jest.fn(),
    addEventListener: jest.fn(),
    removeEventListener: jest.fn(),
    dispatchEvent: jest.fn(),
    readyState: 1,
    // OPEN
    url: url,
    onopen: null,
    onclose: null,
    onmessage: null,
    onerror: null
  };
});

// Sample data for mocking
const mockData = {
  loras: [{
    id: 'test-lora-1',
    name: 'Anime Character LoRA',
    description: 'High-quality anime character style',
    tags: ['anime', 'character'],
    type: 'character',
    file_size: 1024000,
    created_at: '2024-01-01T00:00:00Z',
    updated_at: '2024-01-01T00:00:00Z'
  }, {
    id: 'test-lora-2',
    name: 'Landscape LoRA',
    description: 'Beautiful landscape generation',
    tags: ['landscape', 'nature'],
    type: 'style',
    file_size: 2048000,
    created_at: '2024-01-02T00:00:00Z',
    updated_at: '2024-01-02T00:00:00Z'
  }],
  recommendations: [{
    id: 'rec-1',
    lora_id: 'test-lora-1',
    score: 0.95,
    reason: 'Based on your usage patterns'
  }],
  analytics: {
    kpis: {
      total_loras: 42,
      active_users: 15,
      average_response_time: 250,
      uptime_percentage: 99.5,
      error_rate: 0.01
    },
    usage_stats: {
      downloads_today: 125,
      uploads_today: 8,
      api_calls_today: 1500
    },
    performance_metrics: [{
      timestamp: '2024-01-01T00:00:00Z',
      response_time: 245,
      memory_usage: 75.2
    }, {
      timestamp: '2024-01-01T01:00:00Z',
      response_time: 260,
      memory_usage: 78.1
    }]
  },
  admin: {
    overview: {
      systemInfo: {
        version: '2.1.0',
        uptime: '7 days, 12 hours',
        memory_usage: '2.1 GB',
        cpu_usage: '15%',
        disk_usage: '45%'
      },
      status: 'healthy'
    },
    workers: {
      active: 3,
      idle: 1,
      failed: 0,
      workers: [{
        id: 'worker-1',
        status: 'active',
        task: 'processing_upload'
      }, {
        id: 'worker-2',
        status: 'idle',
        task: null
      }, {
        id: 'worker-3',
        status: 'active',
        task: 'generating_recommendations'
      }]
    }
  }
};

// API Mock Functions
const apiMocks = {
  // LoRA Management
  'GET /api/v1/loras': url => {
    const urlObj = new URL(url, 'http://localhost');
    const page = parseInt(urlObj.searchParams.get('page')) || 1;
    const limit = parseInt(urlObj.searchParams.get('limit')) || 10;
    const tags = urlObj.searchParams.get('tags');
    const type = urlObj.searchParams.get('type');
    let filteredLoras = [...mockData.loras];
    if (tags) {
      const tagArray = tags.split(',');
      filteredLoras = filteredLoras.filter(lora => tagArray.some(tag => lora.tags.includes(tag)));
    }
    if (type) {
      filteredLoras = filteredLoras.filter(lora => lora.type === type);
    }
    const start = (page - 1) * limit;
    const end = start + limit;
    const paginatedLoras = filteredLoras.slice(start, end);
    return {
      loras: paginatedLoras,
      pagination: {
        page,
        limit,
        total: filteredLoras.length,
        pages: Math.ceil(filteredLoras.length / limit)
      }
    };
  },
  'GET /api/v1/loras/:id': url => {
    const id = url.split('/').pop();
    const lora = mockData.loras.find(l => l.id === id);
    if (!lora) {
      throw new Error('LoRA not found');
    }
    return lora;
  },
  'POST /api/v1/loras/upload': (url, options) => {
    // Check if proper form data was sent
    const hasFormData = options.body instanceof FormData;
    if (!hasFormData) {
      throw new Error('File is required');
    }

    // In a real scenario, we'd check if formData has file
    // For mocking, we assume empty FormData means no file
    const isEmpty = options.body.entries ? !Array.from(options.body.entries()).length : false;
    if (isEmpty) {
      throw new Error('File is required');
    }
    return {
      id: 'new-lora-id',
      name: 'Test LoRA',
      // Extract from form data in real implementation
      message: 'LoRA uploaded successfully',
      status: 'processing'
    };
  },
  'DELETE /api/v1/loras/:id': () => ({
    message: 'LoRA deleted successfully'
  }),
  // Recommendations
  'GET /api/v1/recommendations': url => {
    const urlObj = new URL(url, 'http://localhost');
    const limit = parseInt(urlObj.searchParams.get('limit')) || 10;
    return {
      recommendations: mockData.recommendations.slice(0, limit)
    };
  },
  'POST /api/v1/recommendations/feedback': () => ({
    message: 'Feedback recorded successfully'
  }),
  // Analytics
  'GET /api/v1/analytics': url => {
    const urlObj = new URL(url, 'http://localhost');
    const timeRange = urlObj.searchParams.get('timeRange') || '24h';
    return {
      ...mockData.analytics,
      timeRange
    };
  },
  'GET /api/v1/analytics/export': url => {
    const urlObj = new URL(url, 'http://localhost');
    const format = urlObj.searchParams.get('format') || 'json';
    if (format === 'csv') {
      return 'timestamp,response_time,memory_usage\n2024-01-01T00:00:00Z,245,75.2';
    }
    return mockData.analytics;
  },
  // Admin
  'GET /api/v1/admin/overview': () => mockData.admin.overview,
  'GET /api/v1/admin/workers': () => mockData.admin.workers,
  'POST /api/v1/admin/workers/:id/restart': () => ({
    message: 'Worker restarted successfully'
  }),
  // Import/Export
  'POST /api/v1/export': () => new Blob(['mock export data'], {
    type: 'application/json'
  }),
  'POST /api/v1/import': () => ({
    message: 'Import started successfully',
    job_id: 'import-job-123'
  })
};

// Mock fetch implementation
const mockFetch = (url, options = {}) => {
  const method = options.method || 'GET';

  // Extract the path from the full URL
  let path;
  try {
    const urlObj = new URL(url);
    path = urlObj.pathname;
  } catch {
    // If URL parsing fails, assume it's already a path
    path = url;
  }

  // Create keys for exact and pattern matching
  const exactKey = `${method} ${path}`;
  const patternKey = `${method} ${path.replace(/\/[^/]+$/, '/:id')}`;

  // Try exact match first, then pattern match
  const mockFn = apiMocks[exactKey] || apiMocks[patternKey];
  if (!mockFn) {
    // Handle unknown endpoints
    if (url.includes('nonexistent')) {
      return Promise.resolve({
        ok: false,
        status: 404,
        json: () => Promise.resolve({
          error: 'Not found'
        }),
        text: () => Promise.resolve('Not found'),
        headers: new Map([['content-type', 'application/json']])
      });
    }
    console.log(`No mock found for: ${method} ${path} (tried: ${exactKey}, ${patternKey})`);
    return Promise.resolve({
      ok: false,
      status: 500,
      json: () => Promise.resolve({
        error: 'Internal server error'
      }),
      text: () => Promise.resolve('Internal server error')
    });
  }
  try {
    const data = mockFn(url, options);
    const isBlob = data instanceof Blob;
    return Promise.resolve({
      ok: true,
      status: 200,
      json: () => isBlob ? Promise.reject(new Error('Cannot parse blob as JSON')) : Promise.resolve(data),
      text: () => isBlob ? data.text() : Promise.resolve(typeof data === 'string' ? data : JSON.stringify(data)),
      blob: () => isBlob ? Promise.resolve(data) : Promise.resolve(new Blob([JSON.stringify(data)])),
      headers: new Map([['content-type', isBlob ? 'application/octet-stream' : 'application/json']])
    });
  } catch (error) {
    // Handle validation errors with 400 status
    if (error.message.includes('required') || error.message.includes('validation')) {
      return Promise.resolve({
        ok: false,
        status: 400,
        json: () => Promise.resolve({
          error: error.message
        }),
        text: () => Promise.resolve(error.message)
      });
    }

    // Handle not found errors with 404 status
    if (error.message.includes('not found')) {
      return Promise.resolve({
        ok: false,
        status: 404,
        json: () => Promise.resolve({
          error: error.message
        }),
        text: () => Promise.resolve(error.message)
      });
    }

    // Default to 500 for other errors
    return Promise.resolve({
      ok: false,
      status: 500,
      json: () => Promise.resolve({
        error: error.message
      }),
      text: () => Promise.resolve(error.message)
    });
  }
};

// Set up fetch mock
beforeEach(() => {
  fetch.mockImplementation(mockFetch);
});
afterEach(() => {
  fetch.mockClear();
});
module.exports = {
  mockFetch,
  mockData,
  apiMocks
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJnbG9iYWwiLCJmZXRjaCIsImplc3QiLCJmbiIsIldlYlNvY2tldCIsIm1vY2tJbXBsZW1lbnRhdGlvbiIsInVybCIsImNsb3NlIiwic2VuZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZGlzcGF0Y2hFdmVudCIsInJlYWR5U3RhdGUiLCJvbm9wZW4iLCJvbmNsb3NlIiwib25tZXNzYWdlIiwib25lcnJvciIsIm1vY2tEYXRhIiwibG9yYXMiLCJpZCIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsInRhZ3MiLCJ0eXBlIiwiZmlsZV9zaXplIiwiY3JlYXRlZF9hdCIsInVwZGF0ZWRfYXQiLCJyZWNvbW1lbmRhdGlvbnMiLCJsb3JhX2lkIiwic2NvcmUiLCJyZWFzb24iLCJhbmFseXRpY3MiLCJrcGlzIiwidG90YWxfbG9yYXMiLCJhY3RpdmVfdXNlcnMiLCJhdmVyYWdlX3Jlc3BvbnNlX3RpbWUiLCJ1cHRpbWVfcGVyY2VudGFnZSIsImVycm9yX3JhdGUiLCJ1c2FnZV9zdGF0cyIsImRvd25sb2Fkc190b2RheSIsInVwbG9hZHNfdG9kYXkiLCJhcGlfY2FsbHNfdG9kYXkiLCJwZXJmb3JtYW5jZV9tZXRyaWNzIiwidGltZXN0YW1wIiwicmVzcG9uc2VfdGltZSIsIm1lbW9yeV91c2FnZSIsImFkbWluIiwib3ZlcnZpZXciLCJzeXN0ZW1JbmZvIiwidmVyc2lvbiIsInVwdGltZSIsImNwdV91c2FnZSIsImRpc2tfdXNhZ2UiLCJzdGF0dXMiLCJ3b3JrZXJzIiwiYWN0aXZlIiwiaWRsZSIsImZhaWxlZCIsInRhc2siLCJhcGlNb2NrcyIsInVybE9iaiIsIlVSTCIsInBhZ2UiLCJwYXJzZUludCIsInNlYXJjaFBhcmFtcyIsImdldCIsImxpbWl0IiwiZmlsdGVyZWRMb3JhcyIsInRhZ0FycmF5Iiwic3BsaXQiLCJmaWx0ZXIiLCJsb3JhIiwic29tZSIsInRhZyIsImluY2x1ZGVzIiwic3RhcnQiLCJlbmQiLCJwYWdpbmF0ZWRMb3JhcyIsInNsaWNlIiwicGFnaW5hdGlvbiIsInRvdGFsIiwibGVuZ3RoIiwicGFnZXMiLCJNYXRoIiwiY2VpbCIsInBvcCIsImZpbmQiLCJsIiwiRXJyb3IiLCJQT1NUIC9hcGkvdjEvbG9yYXMvdXBsb2FkIiwib3B0aW9ucyIsImhhc0Zvcm1EYXRhIiwiYm9keSIsIkZvcm1EYXRhIiwiaXNFbXB0eSIsImVudHJpZXMiLCJBcnJheSIsImZyb20iLCJtZXNzYWdlIiwiREVMRVRFIC9hcGkvdjEvbG9yYXMvOmlkIiwiUE9TVCAvYXBpL3YxL3JlY29tbWVuZGF0aW9ucy9mZWVkYmFjayIsInRpbWVSYW5nZSIsImZvcm1hdCIsIkdFVCAvYXBpL3YxL2FkbWluL292ZXJ2aWV3IiwiR0VUIC9hcGkvdjEvYWRtaW4vd29ya2VycyIsIlBPU1QgL2FwaS92MS9hZG1pbi93b3JrZXJzLzppZC9yZXN0YXJ0IiwiUE9TVCAvYXBpL3YxL2V4cG9ydCIsIkJsb2IiLCJQT1NUIC9hcGkvdjEvaW1wb3J0Iiwiam9iX2lkIiwibW9ja0ZldGNoIiwibWV0aG9kIiwicGF0aCIsInBhdGhuYW1lIiwiZXhhY3RLZXkiLCJwYXR0ZXJuS2V5IiwicmVwbGFjZSIsIm1vY2tGbiIsIlByb21pc2UiLCJyZXNvbHZlIiwib2siLCJqc29uIiwiZXJyb3IiLCJ0ZXh0IiwiaGVhZGVycyIsIk1hcCIsImNvbnNvbGUiLCJsb2ciLCJkYXRhIiwiaXNCbG9iIiwicmVqZWN0IiwiSlNPTiIsInN0cmluZ2lmeSIsImJsb2IiLCJiZWZvcmVFYWNoIiwiYWZ0ZXJFYWNoIiwibW9ja0NsZWFyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImFwaS1tb2Nrcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEFQSSBNb2NrcyBmb3IgSW50ZWdyYXRpb24gVGVzdHNcbiAqIFByb3ZpZGVzIHJlYWxpc3RpYyBtb2NrIHJlc3BvbnNlcyBmb3IgYWxsIEFQSSBlbmRwb2ludHNcbiAqL1xuXG4vLyBNb2NrIGZldGNoIGdsb2JhbGx5IGZvciBhbGwgdGVzdHNcbmdsb2JhbC5mZXRjaCA9IGplc3QuZm4oKTtcblxuLy8gTW9jayBXZWJTb2NrZXRcbmdsb2JhbC5XZWJTb2NrZXQgPSBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKCh1cmwpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgICBjbG9zZTogamVzdC5mbigpLFxuICAgICAgICBzZW5kOiBqZXN0LmZuKCksXG4gICAgICAgIGFkZEV2ZW50TGlzdGVuZXI6IGplc3QuZm4oKSxcbiAgICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcjogamVzdC5mbigpLFxuICAgICAgICBkaXNwYXRjaEV2ZW50OiBqZXN0LmZuKCksXG4gICAgICAgIHJlYWR5U3RhdGU6IDEsIC8vIE9QRU5cbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIG9ub3BlbjogbnVsbCxcbiAgICAgICAgb25jbG9zZTogbnVsbCxcbiAgICAgICAgb25tZXNzYWdlOiBudWxsLFxuICAgICAgICBvbmVycm9yOiBudWxsXG4gICAgfTtcbn0pO1xuXG4vLyBTYW1wbGUgZGF0YSBmb3IgbW9ja2luZ1xuY29uc3QgbW9ja0RhdGEgPSB7XG4gICAgbG9yYXM6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgaWQ6ICd0ZXN0LWxvcmEtMScsXG4gICAgICAgICAgICBuYW1lOiAnQW5pbWUgQ2hhcmFjdGVyIExvUkEnLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246ICdIaWdoLXF1YWxpdHkgYW5pbWUgY2hhcmFjdGVyIHN0eWxlJyxcbiAgICAgICAgICAgIHRhZ3M6IFsnYW5pbWUnLCAnY2hhcmFjdGVyJ10sXG4gICAgICAgICAgICB0eXBlOiAnY2hhcmFjdGVyJyxcbiAgICAgICAgICAgIGZpbGVfc2l6ZTogMTAyNDAwMCxcbiAgICAgICAgICAgIGNyZWF0ZWRfYXQ6ICcyMDI0LTAxLTAxVDAwOjAwOjAwWicsXG4gICAgICAgICAgICB1cGRhdGVkX2F0OiAnMjAyNC0wMS0wMVQwMDowMDowMFonXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlkOiAndGVzdC1sb3JhLTInLFxuICAgICAgICAgICAgbmFtZTogJ0xhbmRzY2FwZSBMb1JBJyxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnQmVhdXRpZnVsIGxhbmRzY2FwZSBnZW5lcmF0aW9uJyxcbiAgICAgICAgICAgIHRhZ3M6IFsnbGFuZHNjYXBlJywgJ25hdHVyZSddLFxuICAgICAgICAgICAgdHlwZTogJ3N0eWxlJyxcbiAgICAgICAgICAgIGZpbGVfc2l6ZTogMjA0ODAwMCxcbiAgICAgICAgICAgIGNyZWF0ZWRfYXQ6ICcyMDI0LTAxLTAyVDAwOjAwOjAwWicsXG4gICAgICAgICAgICB1cGRhdGVkX2F0OiAnMjAyNC0wMS0wMlQwMDowMDowMFonXG4gICAgICAgIH1cbiAgICBdLFxuICAgIHJlY29tbWVuZGF0aW9uczogW1xuICAgICAgICB7XG4gICAgICAgICAgICBpZDogJ3JlYy0xJyxcbiAgICAgICAgICAgIGxvcmFfaWQ6ICd0ZXN0LWxvcmEtMScsXG4gICAgICAgICAgICBzY29yZTogMC45NSxcbiAgICAgICAgICAgIHJlYXNvbjogJ0Jhc2VkIG9uIHlvdXIgdXNhZ2UgcGF0dGVybnMnXG4gICAgICAgIH1cbiAgICBdLFxuICAgIGFuYWx5dGljczoge1xuICAgICAgICBrcGlzOiB7XG4gICAgICAgICAgICB0b3RhbF9sb3JhczogNDIsXG4gICAgICAgICAgICBhY3RpdmVfdXNlcnM6IDE1LFxuICAgICAgICAgICAgYXZlcmFnZV9yZXNwb25zZV90aW1lOiAyNTAsXG4gICAgICAgICAgICB1cHRpbWVfcGVyY2VudGFnZTogOTkuNSxcbiAgICAgICAgICAgIGVycm9yX3JhdGU6IDAuMDFcbiAgICAgICAgfSxcbiAgICAgICAgdXNhZ2Vfc3RhdHM6IHtcbiAgICAgICAgICAgIGRvd25sb2Fkc190b2RheTogMTI1LFxuICAgICAgICAgICAgdXBsb2Fkc190b2RheTogOCxcbiAgICAgICAgICAgIGFwaV9jYWxsc190b2RheTogMTUwMFxuICAgICAgICB9LFxuICAgICAgICBwZXJmb3JtYW5jZV9tZXRyaWNzOiBbXG4gICAgICAgICAgICB7IHRpbWVzdGFtcDogJzIwMjQtMDEtMDFUMDA6MDA6MDBaJywgcmVzcG9uc2VfdGltZTogMjQ1LCBtZW1vcnlfdXNhZ2U6IDc1LjIgfSxcbiAgICAgICAgICAgIHsgdGltZXN0YW1wOiAnMjAyNC0wMS0wMVQwMTowMDowMFonLCByZXNwb25zZV90aW1lOiAyNjAsIG1lbW9yeV91c2FnZTogNzguMSB9XG4gICAgICAgIF1cbiAgICB9LFxuICAgIGFkbWluOiB7XG4gICAgICAgIG92ZXJ2aWV3OiB7XG4gICAgICAgICAgICBzeXN0ZW1JbmZvOiB7XG4gICAgICAgICAgICAgICAgdmVyc2lvbjogJzIuMS4wJyxcbiAgICAgICAgICAgICAgICB1cHRpbWU6ICc3IGRheXMsIDEyIGhvdXJzJyxcbiAgICAgICAgICAgICAgICBtZW1vcnlfdXNhZ2U6ICcyLjEgR0InLFxuICAgICAgICAgICAgICAgIGNwdV91c2FnZTogJzE1JScsXG4gICAgICAgICAgICAgICAgZGlza191c2FnZTogJzQ1JSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdGF0dXM6ICdoZWFsdGh5J1xuICAgICAgICB9LFxuICAgICAgICB3b3JrZXJzOiB7XG4gICAgICAgICAgICBhY3RpdmU6IDMsXG4gICAgICAgICAgICBpZGxlOiAxLFxuICAgICAgICAgICAgZmFpbGVkOiAwLFxuICAgICAgICAgICAgd29ya2VyczogW1xuICAgICAgICAgICAgICAgIHsgaWQ6ICd3b3JrZXItMScsIHN0YXR1czogJ2FjdGl2ZScsIHRhc2s6ICdwcm9jZXNzaW5nX3VwbG9hZCcgfSxcbiAgICAgICAgICAgICAgICB7IGlkOiAnd29ya2VyLTInLCBzdGF0dXM6ICdpZGxlJywgdGFzazogbnVsbCB9LFxuICAgICAgICAgICAgICAgIHsgaWQ6ICd3b3JrZXItMycsIHN0YXR1czogJ2FjdGl2ZScsIHRhc2s6ICdnZW5lcmF0aW5nX3JlY29tbWVuZGF0aW9ucycgfVxuICAgICAgICAgICAgXVxuICAgICAgICB9XG4gICAgfVxufTtcblxuLy8gQVBJIE1vY2sgRnVuY3Rpb25zXG5jb25zdCBhcGlNb2NrcyA9IHtcbiAgICAvLyBMb1JBIE1hbmFnZW1lbnRcbiAgICAnR0VUIC9hcGkvdjEvbG9yYXMnOiAodXJsKSA9PiB7XG4gICAgICAgIGNvbnN0IHVybE9iaiA9IG5ldyBVUkwodXJsLCAnaHR0cDovL2xvY2FsaG9zdCcpO1xuICAgICAgICBjb25zdCBwYWdlID0gcGFyc2VJbnQodXJsT2JqLnNlYXJjaFBhcmFtcy5nZXQoJ3BhZ2UnKSkgfHwgMTtcbiAgICAgICAgY29uc3QgbGltaXQgPSBwYXJzZUludCh1cmxPYmouc2VhcmNoUGFyYW1zLmdldCgnbGltaXQnKSkgfHwgMTA7XG4gICAgICAgIGNvbnN0IHRhZ3MgPSB1cmxPYmouc2VhcmNoUGFyYW1zLmdldCgndGFncycpO1xuICAgICAgICBjb25zdCB0eXBlID0gdXJsT2JqLnNlYXJjaFBhcmFtcy5nZXQoJ3R5cGUnKTtcbiAgICAgICAgXG4gICAgICAgIGxldCBmaWx0ZXJlZExvcmFzID0gWy4uLm1vY2tEYXRhLmxvcmFzXTtcbiAgICAgICAgXG4gICAgICAgIGlmICh0YWdzKSB7XG4gICAgICAgICAgICBjb25zdCB0YWdBcnJheSA9IHRhZ3Muc3BsaXQoJywnKTtcbiAgICAgICAgICAgIGZpbHRlcmVkTG9yYXMgPSBmaWx0ZXJlZExvcmFzLmZpbHRlcihsb3JhID0+IFxuICAgICAgICAgICAgICAgIHRhZ0FycmF5LnNvbWUodGFnID0+IGxvcmEudGFncy5pbmNsdWRlcyh0YWcpKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAgICAgIGZpbHRlcmVkTG9yYXMgPSBmaWx0ZXJlZExvcmFzLmZpbHRlcihsb3JhID0+IGxvcmEudHlwZSA9PT0gdHlwZSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gKHBhZ2UgLSAxKSAqIGxpbWl0O1xuICAgICAgICBjb25zdCBlbmQgPSBzdGFydCArIGxpbWl0O1xuICAgICAgICBjb25zdCBwYWdpbmF0ZWRMb3JhcyA9IGZpbHRlcmVkTG9yYXMuc2xpY2Uoc3RhcnQsIGVuZCk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbG9yYXM6IHBhZ2luYXRlZExvcmFzLFxuICAgICAgICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICAgICAgICAgIHBhZ2UsXG4gICAgICAgICAgICAgICAgbGltaXQsXG4gICAgICAgICAgICAgICAgdG90YWw6IGZpbHRlcmVkTG9yYXMubGVuZ3RoLFxuICAgICAgICAgICAgICAgIHBhZ2VzOiBNYXRoLmNlaWwoZmlsdGVyZWRMb3Jhcy5sZW5ndGggLyBsaW1pdClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9LFxuICAgIFxuICAgICdHRVQgL2FwaS92MS9sb3Jhcy86aWQnOiAodXJsKSA9PiB7XG4gICAgICAgIGNvbnN0IGlkID0gdXJsLnNwbGl0KCcvJykucG9wKCk7XG4gICAgICAgIGNvbnN0IGxvcmEgPSBtb2NrRGF0YS5sb3Jhcy5maW5kKGwgPT4gbC5pZCA9PT0gaWQpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFsb3JhKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xvUkEgbm90IGZvdW5kJyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBsb3JhO1xuICAgIH0sXG4gICAgXG4gICAgJ1BPU1QgL2FwaS92MS9sb3Jhcy91cGxvYWQnOiAodXJsLCBvcHRpb25zKSA9PiB7XG4gICAgICAgIC8vIENoZWNrIGlmIHByb3BlciBmb3JtIGRhdGEgd2FzIHNlbnRcbiAgICAgICAgY29uc3QgaGFzRm9ybURhdGEgPSBvcHRpb25zLmJvZHkgaW5zdGFuY2VvZiBGb3JtRGF0YTtcbiAgICAgICAgXG4gICAgICAgIGlmICghaGFzRm9ybURhdGEpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmlsZSBpcyByZXF1aXJlZCcpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBJbiBhIHJlYWwgc2NlbmFyaW8sIHdlJ2QgY2hlY2sgaWYgZm9ybURhdGEgaGFzIGZpbGVcbiAgICAgICAgLy8gRm9yIG1vY2tpbmcsIHdlIGFzc3VtZSBlbXB0eSBGb3JtRGF0YSBtZWFucyBubyBmaWxlXG4gICAgICAgIGNvbnN0IGlzRW1wdHkgPSBvcHRpb25zLmJvZHkuZW50cmllcyA/ICFBcnJheS5mcm9tKG9wdGlvbnMuYm9keS5lbnRyaWVzKCkpLmxlbmd0aCA6IGZhbHNlO1xuICAgICAgICBcbiAgICAgICAgaWYgKGlzRW1wdHkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmlsZSBpcyByZXF1aXJlZCcpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaWQ6ICduZXctbG9yYS1pZCcsXG4gICAgICAgICAgICBuYW1lOiAnVGVzdCBMb1JBJywgLy8gRXh0cmFjdCBmcm9tIGZvcm0gZGF0YSBpbiByZWFsIGltcGxlbWVudGF0aW9uXG4gICAgICAgICAgICBtZXNzYWdlOiAnTG9SQSB1cGxvYWRlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgICAgICAgc3RhdHVzOiAncHJvY2Vzc2luZydcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIFxuICAgICdERUxFVEUgL2FwaS92MS9sb3Jhcy86aWQnOiAoKSA9PiAoe1xuICAgICAgICBtZXNzYWdlOiAnTG9SQSBkZWxldGVkIHN1Y2Nlc3NmdWxseSdcbiAgICB9KSxcbiAgICBcbiAgICAvLyBSZWNvbW1lbmRhdGlvbnNcbiAgICAnR0VUIC9hcGkvdjEvcmVjb21tZW5kYXRpb25zJzogKHVybCkgPT4ge1xuICAgICAgICBjb25zdCB1cmxPYmogPSBuZXcgVVJMKHVybCwgJ2h0dHA6Ly9sb2NhbGhvc3QnKTtcbiAgICAgICAgY29uc3QgbGltaXQgPSBwYXJzZUludCh1cmxPYmouc2VhcmNoUGFyYW1zLmdldCgnbGltaXQnKSkgfHwgMTA7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVjb21tZW5kYXRpb25zOiBtb2NrRGF0YS5yZWNvbW1lbmRhdGlvbnMuc2xpY2UoMCwgbGltaXQpXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBcbiAgICAnUE9TVCAvYXBpL3YxL3JlY29tbWVuZGF0aW9ucy9mZWVkYmFjayc6ICgpID0+ICh7XG4gICAgICAgIG1lc3NhZ2U6ICdGZWVkYmFjayByZWNvcmRlZCBzdWNjZXNzZnVsbHknXG4gICAgfSksXG4gICAgXG4gICAgLy8gQW5hbHl0aWNzXG4gICAgJ0dFVCAvYXBpL3YxL2FuYWx5dGljcyc6ICh1cmwpID0+IHtcbiAgICAgICAgY29uc3QgdXJsT2JqID0gbmV3IFVSTCh1cmwsICdodHRwOi8vbG9jYWxob3N0Jyk7XG4gICAgICAgIGNvbnN0IHRpbWVSYW5nZSA9IHVybE9iai5zZWFyY2hQYXJhbXMuZ2V0KCd0aW1lUmFuZ2UnKSB8fCAnMjRoJztcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5tb2NrRGF0YS5hbmFseXRpY3MsXG4gICAgICAgICAgICB0aW1lUmFuZ2VcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIFxuICAgICdHRVQgL2FwaS92MS9hbmFseXRpY3MvZXhwb3J0JzogKHVybCkgPT4ge1xuICAgICAgICBjb25zdCB1cmxPYmogPSBuZXcgVVJMKHVybCwgJ2h0dHA6Ly9sb2NhbGhvc3QnKTtcbiAgICAgICAgY29uc3QgZm9ybWF0ID0gdXJsT2JqLnNlYXJjaFBhcmFtcy5nZXQoJ2Zvcm1hdCcpIHx8ICdqc29uJztcbiAgICAgICAgXG4gICAgICAgIGlmIChmb3JtYXQgPT09ICdjc3YnKSB7XG4gICAgICAgICAgICByZXR1cm4gJ3RpbWVzdGFtcCxyZXNwb25zZV90aW1lLG1lbW9yeV91c2FnZVxcbjIwMjQtMDEtMDFUMDA6MDA6MDBaLDI0NSw3NS4yJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIG1vY2tEYXRhLmFuYWx5dGljcztcbiAgICB9LFxuICAgIFxuICAgIC8vIEFkbWluXG4gICAgJ0dFVCAvYXBpL3YxL2FkbWluL292ZXJ2aWV3JzogKCkgPT4gbW9ja0RhdGEuYWRtaW4ub3ZlcnZpZXcsXG4gICAgXG4gICAgJ0dFVCAvYXBpL3YxL2FkbWluL3dvcmtlcnMnOiAoKSA9PiBtb2NrRGF0YS5hZG1pbi53b3JrZXJzLFxuICAgIFxuICAgICdQT1NUIC9hcGkvdjEvYWRtaW4vd29ya2Vycy86aWQvcmVzdGFydCc6ICgpID0+ICh7XG4gICAgICAgIG1lc3NhZ2U6ICdXb3JrZXIgcmVzdGFydGVkIHN1Y2Nlc3NmdWxseSdcbiAgICB9KSxcbiAgICBcbiAgICAvLyBJbXBvcnQvRXhwb3J0XG4gICAgJ1BPU1QgL2FwaS92MS9leHBvcnQnOiAoKSA9PiBuZXcgQmxvYihbJ21vY2sgZXhwb3J0IGRhdGEnXSwgeyB0eXBlOiAnYXBwbGljYXRpb24vanNvbicgfSksXG4gICAgXG4gICAgJ1BPU1QgL2FwaS92MS9pbXBvcnQnOiAoKSA9PiAoe1xuICAgICAgICBtZXNzYWdlOiAnSW1wb3J0IHN0YXJ0ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICAgICAgam9iX2lkOiAnaW1wb3J0LWpvYi0xMjMnXG4gICAgfSlcbn07XG5cbi8vIE1vY2sgZmV0Y2ggaW1wbGVtZW50YXRpb25cbmNvbnN0IG1vY2tGZXRjaCA9ICh1cmwsIG9wdGlvbnMgPSB7fSkgPT4ge1xuICAgIGNvbnN0IG1ldGhvZCA9IG9wdGlvbnMubWV0aG9kIHx8ICdHRVQnO1xuICAgIFxuICAgIC8vIEV4dHJhY3QgdGhlIHBhdGggZnJvbSB0aGUgZnVsbCBVUkxcbiAgICBsZXQgcGF0aDtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB1cmxPYmogPSBuZXcgVVJMKHVybCk7XG4gICAgICAgIHBhdGggPSB1cmxPYmoucGF0aG5hbWU7XG4gICAgfSBjYXRjaCB7XG4gICAgICAgIC8vIElmIFVSTCBwYXJzaW5nIGZhaWxzLCBhc3N1bWUgaXQncyBhbHJlYWR5IGEgcGF0aFxuICAgICAgICBwYXRoID0gdXJsO1xuICAgIH1cbiAgICBcbiAgICAvLyBDcmVhdGUga2V5cyBmb3IgZXhhY3QgYW5kIHBhdHRlcm4gbWF0Y2hpbmdcbiAgICBjb25zdCBleGFjdEtleSA9IGAke21ldGhvZH0gJHtwYXRofWA7XG4gICAgY29uc3QgcGF0dGVybktleSA9IGAke21ldGhvZH0gJHtwYXRoLnJlcGxhY2UoL1xcL1teL10rJC8sICcvOmlkJyl9YDtcbiAgICBcbiAgICAvLyBUcnkgZXhhY3QgbWF0Y2ggZmlyc3QsIHRoZW4gcGF0dGVybiBtYXRjaFxuICAgIGNvbnN0IG1vY2tGbiA9IGFwaU1vY2tzW2V4YWN0S2V5XSB8fCBhcGlNb2Nrc1twYXR0ZXJuS2V5XTtcbiAgICBcbiAgICBpZiAoIW1vY2tGbikge1xuICAgICAgICAvLyBIYW5kbGUgdW5rbm93biBlbmRwb2ludHNcbiAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnbm9uZXhpc3RlbnQnKSkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgICAgb2s6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHN0YXR1czogNDA0LFxuICAgICAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IGVycm9yOiAnTm90IGZvdW5kJyB9KSxcbiAgICAgICAgICAgICAgICB0ZXh0OiAoKSA9PiBQcm9taXNlLnJlc29sdmUoJ05vdCBmb3VuZCcpLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IG5ldyBNYXAoW1snY29udGVudC10eXBlJywgJ2FwcGxpY2F0aW9uL2pzb24nXV0pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coYE5vIG1vY2sgZm91bmQgZm9yOiAke21ldGhvZH0gJHtwYXRofSAodHJpZWQ6ICR7ZXhhY3RLZXl9LCAke3BhdHRlcm5LZXl9KWApO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogZmFsc2UsXG4gICAgICAgICAgICBzdGF0dXM6IDUwMCxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyB9KSxcbiAgICAgICAgICAgIHRleHQ6ICgpID0+IFByb21pc2UucmVzb2x2ZSgnSW50ZXJuYWwgc2VydmVyIGVycm9yJylcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBtb2NrRm4odXJsLCBvcHRpb25zKTtcbiAgICAgICAgY29uc3QgaXNCbG9iID0gZGF0YSBpbnN0YW5jZW9mIEJsb2I7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBpc0Jsb2IgPyBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ0Nhbm5vdCBwYXJzZSBibG9iIGFzIEpTT04nKSkgOiBQcm9taXNlLnJlc29sdmUoZGF0YSksXG4gICAgICAgICAgICB0ZXh0OiAoKSA9PiBpc0Jsb2IgPyBkYXRhLnRleHQoKSA6IFByb21pc2UucmVzb2x2ZSh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycgPyBkYXRhIDogSlNPTi5zdHJpbmdpZnkoZGF0YSkpLFxuICAgICAgICAgICAgYmxvYjogKCkgPT4gaXNCbG9iID8gUHJvbWlzZS5yZXNvbHZlKGRhdGEpIDogUHJvbWlzZS5yZXNvbHZlKG5ldyBCbG9iKFtKU09OLnN0cmluZ2lmeShkYXRhKV0pKSxcbiAgICAgICAgICAgIGhlYWRlcnM6IG5ldyBNYXAoW1xuICAgICAgICAgICAgICAgIFsnY29udGVudC10eXBlJywgaXNCbG9iID8gJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbScgOiAnYXBwbGljYXRpb24vanNvbiddXG4gICAgICAgICAgICBdKVxuICAgICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAvLyBIYW5kbGUgdmFsaWRhdGlvbiBlcnJvcnMgd2l0aCA0MDAgc3RhdHVzXG4gICAgICAgIGlmIChlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdyZXF1aXJlZCcpIHx8IGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ3ZhbGlkYXRpb24nKSkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgICAgb2s6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHN0YXR1czogNDAwLFxuICAgICAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0pLFxuICAgICAgICAgICAgICAgIHRleHQ6ICgpID0+IFByb21pc2UucmVzb2x2ZShlcnJvci5tZXNzYWdlKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEhhbmRsZSBub3QgZm91bmQgZXJyb3JzIHdpdGggNDA0IHN0YXR1c1xuICAgICAgICBpZiAoZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnbm90IGZvdW5kJykpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgICAgIG9rOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBzdGF0dXM6IDQwNCxcbiAgICAgICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9KSxcbiAgICAgICAgICAgICAgICB0ZXh0OiAoKSA9PiBQcm9taXNlLnJlc29sdmUoZXJyb3IubWVzc2FnZSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBEZWZhdWx0IHRvIDUwMCBmb3Igb3RoZXIgZXJyb3JzXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IGZhbHNlLFxuICAgICAgICAgICAgc3RhdHVzOiA1MDAsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9KSxcbiAgICAgICAgICAgIHRleHQ6ICgpID0+IFByb21pc2UucmVzb2x2ZShlcnJvci5tZXNzYWdlKVxuICAgICAgICB9KTtcbiAgICB9XG59O1xuXG4vLyBTZXQgdXAgZmV0Y2ggbW9ja1xuYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgZmV0Y2gubW9ja0ltcGxlbWVudGF0aW9uKG1vY2tGZXRjaCk7XG59KTtcblxuYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBmZXRjaC5tb2NrQ2xlYXIoKTtcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBtb2NrRmV0Y2gsXG4gICAgbW9ja0RhdGEsXG4gICAgYXBpTW9ja3Ncbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0FBLE1BQU0sQ0FBQ0MsS0FBSyxHQUFHQyxJQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDOztBQUV4QjtBQUNBSCxNQUFNLENBQUNJLFNBQVMsR0FBR0YsSUFBSSxDQUFDQyxFQUFFLENBQUMsQ0FBQyxDQUFDRSxrQkFBa0IsQ0FBRUMsR0FBRyxJQUFLO0VBQ3JELE9BQU87SUFDSEMsS0FBSyxFQUFFTCxJQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDO0lBQ2hCSyxJQUFJLEVBQUVOLElBQUksQ0FBQ0MsRUFBRSxDQUFDLENBQUM7SUFDZk0sZ0JBQWdCLEVBQUVQLElBQUksQ0FBQ0MsRUFBRSxDQUFDLENBQUM7SUFDM0JPLG1CQUFtQixFQUFFUixJQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDO0lBQzlCUSxhQUFhLEVBQUVULElBQUksQ0FBQ0MsRUFBRSxDQUFDLENBQUM7SUFDeEJTLFVBQVUsRUFBRSxDQUFDO0lBQUU7SUFD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