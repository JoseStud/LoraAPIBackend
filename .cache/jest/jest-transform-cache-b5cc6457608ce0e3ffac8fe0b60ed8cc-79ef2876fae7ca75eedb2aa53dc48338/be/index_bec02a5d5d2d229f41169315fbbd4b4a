28724b2894d60436311f0e6482467f6e
/**
 * Generation Studio - Main Component Module
 * 
 * Integrates all generation studio modules into a unified Alpine.js component.
 */

/**
 * Creates the main generation studio Alpine.js component
 */
function generationStudio() {
  // Initialize state
  const state = window.generationState.createInitialState();

  // Initialize WebSocket connection manager
  const wsManager = window.generationWebSocket.createConnectionManager({
    onOpen: () => {
      window.generationState.setConnectionStatus(state, true);
      window.generationUI.toast.success('Connected to real-time updates');
    },
    onMessage: messageInfo => {
      handleWebSocketMessage(messageInfo);
    },
    onClose: () => {
      window.generationState.setConnectionStatus(state, false);
    },
    onError: _error => {
      window.generationUI.toast.error('Connection error: Real-time updates may be delayed');
    }
  });

  // Handle WebSocket messages
  function handleWebSocketMessage(messageInfo) {
    switch (messageInfo.type) {
      case 'generation_progress':
        handleProgressUpdate(messageInfo.payload);
        break;
      case 'generation_complete':
        handleGenerationComplete(messageInfo.payload);
        break;
      case 'generation_error':
        handleGenerationError(messageInfo.payload);
        break;
      case 'queue_update':
        handleQueueUpdate(messageInfo.payload);
        break;
      case 'system_status':
        handleSystemStatus(messageInfo.payload);
        break;
    }
  }

  // Handle progress updates
  function handleProgressUpdate(payload) {
    const job = window.generationState.getJobById(state, payload.jobId);
    if (job) {
      const updatedJob = window.generationProgress.updateJobProgress(job, payload);
      if (updatedJob) {
        window.generationState.updateActiveJob(state, payload.jobId, updatedJob);
      }
    }
  }

  // Handle generation completion
  function handleGenerationComplete(payload) {
    // Remove from active jobs
    window.generationState.removeActiveJob(state, payload.jobId);

    // Add to recent results
    window.generationState.addRecentResult(state, payload);
    window.generationUI.toast.success('Generation completed successfully');
  }

  // Handle generation errors
  function handleGenerationError(payload) {
    // Remove from active jobs
    window.generationState.removeActiveJob(state, payload.jobId);
    window.generationUI.toast.error(`Generation failed: ${payload.error}`);
  }

  // Handle queue updates
  function handleQueueUpdate(payload) {
    state.activeJobs = payload.jobs || [];
  }

  // Handle system status updates
  function handleSystemStatus(payload) {
    window.generationState.updateSystemStatus(state, payload.status);
  }
  return {
    // Expose state
    ...state,
    // Initialization
    async init() {
      try {
        // Load initial data
        await this.loadData();

        // Load parameters from URL
        const urlParams = window.generationUI.url.loadGenerationParams();
        if (Object.keys(urlParams).length > 0) {
          window.generationState.updateParams(state, urlParams);
          window.generationUI.toast.info('Parameters loaded from URL');
        }

        // Load user preferences
        const preferences = window.generationUI.storage.loadPreferences();
        if (preferences.autoSaveParams) {
          this.setupAutoSave();
        }

        // Initialize WebSocket connection
        wsManager.connect();

        // Setup keyboard shortcuts
        this.setupKeyboardShortcuts();

        // Start polling as fallback
        this.startPolling();
      } catch (error) {
        window.generationUI.toast.error('Failed to initialize Generation Studio');
      }
    },
    // Data loading methods
    async loadData() {
      const [systemResult, jobsResult, resultsResult] = await Promise.all([window.generationAPI.loadSystemStatus(), window.generationAPI.loadActiveJobs(), window.generationAPI.loadRecentResults(state.showHistory ? 50 : 10)]);
      if (systemResult.success) {
        window.generationState.updateSystemStatus(state, systemResult.data);
      }
      if (jobsResult.success) {
        state.activeJobs = jobsResult.data;
      }
      if (resultsResult.success) {
        state.recentResults = resultsResult.data.map(result => window.generationResults.formatResult(result));
      }
    },
    async refreshData() {
      await this.loadData();
      window.generationUI.toast.success('Data refreshed');
    },
    // Generation methods
    async startGeneration() {
      const validation = window.generationUI.validation.validatePrompt(state.params.prompt);
      if (!validation.isValid) {
        window.generationUI.toast.error(validation.errors[0]);
        return;
      }
      window.generationState.setGenerationStatus(state, true);
      try {
        const result = await window.generationAPI.startGeneration(state.params);
        if (result.success) {
          // Add job to state
          window.generationState.addActiveJob(state, {
            id: result.data.job_id,
            ...state.params,
            status: result.data.status || 'queued'
          });
          window.generationUI.toast.success('Generation started successfully');

          // Save parameters to URL if auto-save is enabled
          const preferences = window.generationUI.storage.loadPreferences();
          if (preferences.autoSaveParams) {
            window.generationUI.url.saveGenerationParams(state.params);
          }
        } else {
          window.generationUI.toast.error(result.error || 'Generation failed');
        }
      } catch (error) {
        window.generationUI.toast.error('Error starting generation');
      } finally {
        window.generationState.setGenerationStatus(state, false);
      }
    },
    async cancelJob(jobId) {
      try {
        const result = await window.generationAPI.cancelJob(jobId);
        if (result.success) {
          window.generationState.removeActiveJob(state, jobId);
          window.generationUI.toast.success('Generation cancelled');
        } else {
          window.generationUI.toast.error('Failed to cancel generation');
        }
      } catch (error) {
        window.generationUI.toast.error('Error cancelling generation');
      }
    },
    async clearQueue() {
      const queuedJobs = state.activeJobs.filter(job => job.status === 'queued');
      if (queuedJobs.length === 0) {
        window.generationUI.toast.info('No queued jobs to clear');
        return;
      }
      const confirmed = confirm(`Clear ${queuedJobs.length} queued job(s)?`);
      if (!confirmed) return;
      try {
        const promises = queuedJobs.map(job => this.cancelJob(job.id));
        await Promise.all(promises);
        window.generationUI.toast.success(`Cleared ${queuedJobs.length} queued jobs`);
      } catch (error) {
        window.generationUI.toast.error('Error clearing queue');
      }
    },
    // Result management methods
    showImageModal(result) {
      window.generationState.showResultModal(state, result);
    },
    hideImageModal() {
      window.generationState.hideResultModal(state);
    },
    reuseParameters(result) {
      const params = window.generationResults.extractParameters(result);
      if (params) {
        window.generationState.updateParams(state, params);
        window.generationUI.toast.success('Parameters loaded from result');
      }
    },
    async deleteResult(resultId) {
      const confirmed = confirm('Are you sure you want to delete this result?');
      if (!confirmed) return;
      try {
        const result = await window.generationAPI.deleteResult(resultId);
        if (result.success) {
          window.generationState.removeRecentResult(state, resultId);
          window.generationUI.toast.success('Result deleted');
        } else {
          window.generationUI.toast.error('Failed to delete result');
        }
      } catch (error) {
        window.generationUI.toast.error('Error deleting result');
      }
    },
    async downloadResult(result) {
      try {
        const response = await window.generationAPI.downloadResult(result.id);
        if (response.success) {
          window.generationUI.download.blob(response.data.blob, response.data.filename);
          window.generationUI.toast.success('Download started');
        } else {
          window.generationUI.toast.error('Download failed');
        }
      } catch (error) {
        window.generationUI.toast.error('Error downloading result');
      }
    },
    // Quick action methods
    useRandomPrompt() {
      const randomPrompt = window.generationUI.random.getPrompt();
      window.generationState.updateParams(state, {
        prompt: randomPrompt
      });
      window.generationUI.toast.success('Random prompt generated');
    },
    useRandomSeed() {
      const randomSeed = window.generationUI.random.getSeed();
      window.generationState.updateParams(state, {
        seed: randomSeed
      });
      window.generationUI.toast.success('Random seed generated');
    },
    saveAsPreset() {
      const name = prompt('Enter a name for this preset:');
      if (!name || !name.trim()) return;
      try {
        const preset = window.generationUI.storage.savePreset(name.trim(), state.params);
        window.generationUI.toast.success(`Preset "${preset.name}" saved`);
      } catch (error) {
        window.generationUI.toast.error('Failed to save preset');
      }
    },
    loadPreset(preset) {
      if (!preset || !preset.params) return;
      window.generationState.updateParams(state, preset.params);
      window.generationUI.toast.success(`Preset "${preset.name}" loaded`);
    },
    // UI utility methods
    toggleHistory() {
      const showHistory = window.generationState.toggleHistory(state);
      this.loadRecentResults(showHistory ? 50 : 10);
    },
    async copyPrompt(prompt) {
      const success = await window.generationUI.clipboard.copyText(prompt);
      if (success) {
        window.generationUI.toast.success('Prompt copied to clipboard');
      } else {
        window.generationUI.toast.error('Failed to copy prompt');
      }
    },
    async copyParameters(result) {
      const params = window.generationResults.extractParameters(result);
      const success = await window.generationUI.clipboard.copyParams(params);
      if (success) {
        window.generationUI.toast.success('Parameters copied to clipboard');
      } else {
        window.generationUI.toast.error('Failed to copy parameters');
      }
    },
    // Progress and status methods
    getJobProgress(job) {
      return window.generationProgress.getProgressBarConfig(job);
    },
    formatDuration(seconds) {
      return window.generationProgress.formatDuration(seconds);
    },
    formatFileSize(bytes) {
      return window.generationResults.formatFileSize(bytes);
    },
    formatDate(dateString) {
      return window.generationResults.formatDate(dateString);
    },
    getStatistics() {
      return window.generationState.getStatistics(state);
    },
    // Setup methods
    setupAutoSave() {
      // Save parameters to localStorage periodically
      setInterval(() => {
        window.generationUI.storage.set('lastParams', state.params);
      }, 30000); // Every 30 seconds
    },
    setupKeyboardShortcuts() {
      return window.generationUI.keyboard.init({
        startGeneration: () => this.startGeneration(),
        refreshResults: () => this.refreshData(),
        savePreset: () => this.saveAsPreset(),
        clearQueue: () => this.clearQueue(),
        randomPrompt: () => this.useRandomPrompt(),
        closeModal: () => this.hideImageModal()
      });
    },
    startPolling() {
      if (state.pollInterval) return;
      state.pollInterval = setInterval(async () => {
        if (state.activeJobs.length > 0 || !wsManager.isConnected()) {
          const result = await window.generationAPI.loadActiveJobs();
          if (result.success) {
            state.activeJobs = result.data;
          }
        }
      }, state.config.pollIntervalMs);
    },
    stopPolling() {
      if (state.pollInterval) {
        clearInterval(state.pollInterval);
        state.pollInterval = null;
      }
    },
    // Cleanup
    destroy() {
      this.stopPolling();
      wsManager.destroy();
      if (this.keyboardCleanup) {
        this.keyboardCleanup();
      }
    },
    // Alpine.js reactive getters
    get sortedActiveJobs() {
      return window.generationProgress.sortJobsByPriority(state.activeJobs);
    },
    get recentResultsDisplay() {
      return state.recentResults.slice(0, state.showHistory ? 50 : 10);
    },
    get systemHealth() {
      return window.generationState.isSystemHealthy(state);
    },
    get connectionStatus() {
      return wsManager.getStatus();
    },
    get hasActiveJobs() {
      return state.activeJobs.length > 0;
    },
    get hasRecentResults() {
      return state.recentResults.length > 0;
    },
    get canGenerate() {
      return !state.isGenerating && state.params.prompt.trim().length > 0;
    }
  };
}

// Export for use in templates
if (typeof window !== 'undefined') {
  window.generationStudio = generationStudio;
}

// Export for CommonJS testing environments
if (typeof module !== 'undefined' && module.exports) {
  module.exports = {
    generationStudio
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJnZW5lcmF0aW9uU3R1ZGlvIiwic3RhdGUiLCJ3aW5kb3ciLCJnZW5lcmF0aW9uU3RhdGUiLCJjcmVhdGVJbml0aWFsU3RhdGUiLCJ3c01hbmFnZXIiLCJnZW5lcmF0aW9uV2ViU29ja2V0IiwiY3JlYXRlQ29ubmVjdGlvbk1hbmFnZXIiLCJvbk9wZW4iLCJzZXRDb25uZWN0aW9uU3RhdHVzIiwiZ2VuZXJhdGlvblVJIiwidG9hc3QiLCJzdWNjZXNzIiwib25NZXNzYWdlIiwibWVzc2FnZUluZm8iLCJoYW5kbGVXZWJTb2NrZXRNZXNzYWdlIiwib25DbG9zZSIsIm9uRXJyb3IiLCJfZXJyb3IiLCJlcnJvciIsInR5cGUiLCJoYW5kbGVQcm9ncmVzc1VwZGF0ZSIsInBheWxvYWQiLCJoYW5kbGVHZW5lcmF0aW9uQ29tcGxldGUiLCJoYW5kbGVHZW5lcmF0aW9uRXJyb3IiLCJoYW5kbGVRdWV1ZVVwZGF0ZSIsImhhbmRsZVN5c3RlbVN0YXR1cyIsImpvYiIsImdldEpvYkJ5SWQiLCJqb2JJZCIsInVwZGF0ZWRKb2IiLCJnZW5lcmF0aW9uUHJvZ3Jlc3MiLCJ1cGRhdGVKb2JQcm9ncmVzcyIsInVwZGF0ZUFjdGl2ZUpvYiIsInJlbW92ZUFjdGl2ZUpvYiIsImFkZFJlY2VudFJlc3VsdCIsImFjdGl2ZUpvYnMiLCJqb2JzIiwidXBkYXRlU3lzdGVtU3RhdHVzIiwic3RhdHVzIiwiaW5pdCIsImxvYWREYXRhIiwidXJsUGFyYW1zIiwidXJsIiwibG9hZEdlbmVyYXRpb25QYXJhbXMiLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwidXBkYXRlUGFyYW1zIiwiaW5mbyIsInByZWZlcmVuY2VzIiwic3RvcmFnZSIsImxvYWRQcmVmZXJlbmNlcyIsImF1dG9TYXZlUGFyYW1zIiwic2V0dXBBdXRvU2F2ZSIsImNvbm5lY3QiLCJzZXR1cEtleWJvYXJkU2hvcnRjdXRzIiwic3RhcnRQb2xsaW5nIiwic3lzdGVtUmVzdWx0Iiwiam9ic1Jlc3VsdCIsInJlc3VsdHNSZXN1bHQiLCJQcm9taXNlIiwiYWxsIiwiZ2VuZXJhdGlvbkFQSSIsImxvYWRTeXN0ZW1TdGF0dXMiLCJsb2FkQWN0aXZlSm9icyIsImxvYWRSZWNlbnRSZXN1bHRzIiwic2hvd0hpc3RvcnkiLCJkYXRhIiwicmVjZW50UmVzdWx0cyIsIm1hcCIsInJlc3VsdCIsImdlbmVyYXRpb25SZXN1bHRzIiwiZm9ybWF0UmVzdWx0IiwicmVmcmVzaERhdGEiLCJzdGFydEdlbmVyYXRpb24iLCJ2YWxpZGF0aW9uIiwidmFsaWRhdGVQcm9tcHQiLCJwYXJhbXMiLCJwcm9tcHQiLCJpc1ZhbGlkIiwiZXJyb3JzIiwic2V0R2VuZXJhdGlvblN0YXR1cyIsImFkZEFjdGl2ZUpvYiIsImlkIiwiam9iX2lkIiwic2F2ZUdlbmVyYXRpb25QYXJhbXMiLCJjYW5jZWxKb2IiLCJjbGVhclF1ZXVlIiwicXVldWVkSm9icyIsImZpbHRlciIsImNvbmZpcm1lZCIsImNvbmZpcm0iLCJwcm9taXNlcyIsInNob3dJbWFnZU1vZGFsIiwic2hvd1Jlc3VsdE1vZGFsIiwiaGlkZUltYWdlTW9kYWwiLCJoaWRlUmVzdWx0TW9kYWwiLCJyZXVzZVBhcmFtZXRlcnMiLCJleHRyYWN0UGFyYW1ldGVycyIsImRlbGV0ZVJlc3VsdCIsInJlc3VsdElkIiwicmVtb3ZlUmVjZW50UmVzdWx0IiwiZG93bmxvYWRSZXN1bHQiLCJyZXNwb25zZSIsImRvd25sb2FkIiwiYmxvYiIsImZpbGVuYW1lIiwidXNlUmFuZG9tUHJvbXB0IiwicmFuZG9tUHJvbXB0IiwicmFuZG9tIiwiZ2V0UHJvbXB0IiwidXNlUmFuZG9tU2VlZCIsInJhbmRvbVNlZWQiLCJnZXRTZWVkIiwic2VlZCIsInNhdmVBc1ByZXNldCIsIm5hbWUiLCJ0cmltIiwicHJlc2V0Iiwic2F2ZVByZXNldCIsImxvYWRQcmVzZXQiLCJ0b2dnbGVIaXN0b3J5IiwiY29weVByb21wdCIsImNsaXBib2FyZCIsImNvcHlUZXh0IiwiY29weVBhcmFtZXRlcnMiLCJjb3B5UGFyYW1zIiwiZ2V0Sm9iUHJvZ3Jlc3MiLCJnZXRQcm9ncmVzc0JhckNvbmZpZyIsImZvcm1hdER1cmF0aW9uIiwic2Vjb25kcyIsImZvcm1hdEZpbGVTaXplIiwiYnl0ZXMiLCJmb3JtYXREYXRlIiwiZGF0ZVN0cmluZyIsImdldFN0YXRpc3RpY3MiLCJzZXRJbnRlcnZhbCIsInNldCIsImtleWJvYXJkIiwicmVmcmVzaFJlc3VsdHMiLCJjbG9zZU1vZGFsIiwicG9sbEludGVydmFsIiwiaXNDb25uZWN0ZWQiLCJjb25maWciLCJwb2xsSW50ZXJ2YWxNcyIsInN0b3BQb2xsaW5nIiwiY2xlYXJJbnRlcnZhbCIsImRlc3Ryb3kiLCJrZXlib2FyZENsZWFudXAiLCJzb3J0ZWRBY3RpdmVKb2JzIiwic29ydEpvYnNCeVByaW9yaXR5IiwicmVjZW50UmVzdWx0c0Rpc3BsYXkiLCJzbGljZSIsInN5c3RlbUhlYWx0aCIsImlzU3lzdGVtSGVhbHRoeSIsImNvbm5lY3Rpb25TdGF0dXMiLCJnZXRTdGF0dXMiLCJoYXNBY3RpdmVKb2JzIiwiaGFzUmVjZW50UmVzdWx0cyIsImNhbkdlbmVyYXRlIiwiaXNHZW5lcmF0aW5nIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogR2VuZXJhdGlvbiBTdHVkaW8gLSBNYWluIENvbXBvbmVudCBNb2R1bGVcbiAqIFxuICogSW50ZWdyYXRlcyBhbGwgZ2VuZXJhdGlvbiBzdHVkaW8gbW9kdWxlcyBpbnRvIGEgdW5pZmllZCBBbHBpbmUuanMgY29tcG9uZW50LlxuICovXG5cbi8qKlxuICogQ3JlYXRlcyB0aGUgbWFpbiBnZW5lcmF0aW9uIHN0dWRpbyBBbHBpbmUuanMgY29tcG9uZW50XG4gKi9cbmZ1bmN0aW9uIGdlbmVyYXRpb25TdHVkaW8oKSB7XG4gICAgLy8gSW5pdGlhbGl6ZSBzdGF0ZVxuICAgIGNvbnN0IHN0YXRlID0gd2luZG93LmdlbmVyYXRpb25TdGF0ZS5jcmVhdGVJbml0aWFsU3RhdGUoKTtcbiAgICBcbiAgICAvLyBJbml0aWFsaXplIFdlYlNvY2tldCBjb25uZWN0aW9uIG1hbmFnZXJcbiAgICBjb25zdCB3c01hbmFnZXIgPSB3aW5kb3cuZ2VuZXJhdGlvbldlYlNvY2tldC5jcmVhdGVDb25uZWN0aW9uTWFuYWdlcih7XG4gICAgICAgIG9uT3BlbjogKCkgPT4ge1xuICAgICAgICAgICAgd2luZG93LmdlbmVyYXRpb25TdGF0ZS5zZXRDb25uZWN0aW9uU3RhdHVzKHN0YXRlLCB0cnVlKTtcbiAgICAgICAgICAgIHdpbmRvdy5nZW5lcmF0aW9uVUkudG9hc3Quc3VjY2VzcygnQ29ubmVjdGVkIHRvIHJlYWwtdGltZSB1cGRhdGVzJyk7XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBvbk1lc3NhZ2U6IChtZXNzYWdlSW5mbykgPT4ge1xuICAgICAgICAgICAgaGFuZGxlV2ViU29ja2V0TWVzc2FnZShtZXNzYWdlSW5mbyk7XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBvbkNsb3NlOiAoKSA9PiB7XG4gICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblN0YXRlLnNldENvbm5lY3Rpb25TdGF0dXMoc3RhdGUsIGZhbHNlKTtcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIG9uRXJyb3I6IChfZXJyb3IpID0+IHtcbiAgICAgICAgICAgIHdpbmRvdy5nZW5lcmF0aW9uVUkudG9hc3QuZXJyb3IoJ0Nvbm5lY3Rpb24gZXJyb3I6IFJlYWwtdGltZSB1cGRhdGVzIG1heSBiZSBkZWxheWVkJyk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBcbiAgICAvLyBIYW5kbGUgV2ViU29ja2V0IG1lc3NhZ2VzXG4gICAgZnVuY3Rpb24gaGFuZGxlV2ViU29ja2V0TWVzc2FnZShtZXNzYWdlSW5mbykge1xuICAgICAgICBzd2l0Y2ggKG1lc3NhZ2VJbmZvLnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ2dlbmVyYXRpb25fcHJvZ3Jlc3MnOlxuICAgICAgICAgICAgICAgIGhhbmRsZVByb2dyZXNzVXBkYXRlKG1lc3NhZ2VJbmZvLnBheWxvYWQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZ2VuZXJhdGlvbl9jb21wbGV0ZSc6XG4gICAgICAgICAgICAgICAgaGFuZGxlR2VuZXJhdGlvbkNvbXBsZXRlKG1lc3NhZ2VJbmZvLnBheWxvYWQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZ2VuZXJhdGlvbl9lcnJvcic6XG4gICAgICAgICAgICAgICAgaGFuZGxlR2VuZXJhdGlvbkVycm9yKG1lc3NhZ2VJbmZvLnBheWxvYWQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncXVldWVfdXBkYXRlJzpcbiAgICAgICAgICAgICAgICBoYW5kbGVRdWV1ZVVwZGF0ZShtZXNzYWdlSW5mby5wYXlsb2FkKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3N5c3RlbV9zdGF0dXMnOlxuICAgICAgICAgICAgICAgIGhhbmRsZVN5c3RlbVN0YXR1cyhtZXNzYWdlSW5mby5wYXlsb2FkKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBIYW5kbGUgcHJvZ3Jlc3MgdXBkYXRlc1xuICAgIGZ1bmN0aW9uIGhhbmRsZVByb2dyZXNzVXBkYXRlKHBheWxvYWQpIHtcbiAgICAgICAgY29uc3Qgam9iID0gd2luZG93LmdlbmVyYXRpb25TdGF0ZS5nZXRKb2JCeUlkKHN0YXRlLCBwYXlsb2FkLmpvYklkKTtcbiAgICAgICAgaWYgKGpvYikge1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlZEpvYiA9IHdpbmRvdy5nZW5lcmF0aW9uUHJvZ3Jlc3MudXBkYXRlSm9iUHJvZ3Jlc3Moam9iLCBwYXlsb2FkKTtcbiAgICAgICAgICAgIGlmICh1cGRhdGVkSm9iKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmdlbmVyYXRpb25TdGF0ZS51cGRhdGVBY3RpdmVKb2Ioc3RhdGUsIHBheWxvYWQuam9iSWQsIHVwZGF0ZWRKb2IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIEhhbmRsZSBnZW5lcmF0aW9uIGNvbXBsZXRpb25cbiAgICBmdW5jdGlvbiBoYW5kbGVHZW5lcmF0aW9uQ29tcGxldGUocGF5bG9hZCkge1xuICAgICAgICAvLyBSZW1vdmUgZnJvbSBhY3RpdmUgam9ic1xuICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblN0YXRlLnJlbW92ZUFjdGl2ZUpvYihzdGF0ZSwgcGF5bG9hZC5qb2JJZCk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgdG8gcmVjZW50IHJlc3VsdHNcbiAgICAgICAgd2luZG93LmdlbmVyYXRpb25TdGF0ZS5hZGRSZWNlbnRSZXN1bHQoc3RhdGUsIHBheWxvYWQpO1xuICAgICAgICBcbiAgICAgICAgd2luZG93LmdlbmVyYXRpb25VSS50b2FzdC5zdWNjZXNzKCdHZW5lcmF0aW9uIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHknKTtcbiAgICB9XG4gICAgXG4gICAgLy8gSGFuZGxlIGdlbmVyYXRpb24gZXJyb3JzXG4gICAgZnVuY3Rpb24gaGFuZGxlR2VuZXJhdGlvbkVycm9yKHBheWxvYWQpIHtcbiAgICAgICAgLy8gUmVtb3ZlIGZyb20gYWN0aXZlIGpvYnNcbiAgICAgICAgd2luZG93LmdlbmVyYXRpb25TdGF0ZS5yZW1vdmVBY3RpdmVKb2Ioc3RhdGUsIHBheWxvYWQuam9iSWQpO1xuICAgICAgICBcbiAgICAgICAgd2luZG93LmdlbmVyYXRpb25VSS50b2FzdC5lcnJvcihgR2VuZXJhdGlvbiBmYWlsZWQ6ICR7cGF5bG9hZC5lcnJvcn1gKTtcbiAgICB9XG4gICAgXG4gICAgLy8gSGFuZGxlIHF1ZXVlIHVwZGF0ZXNcbiAgICBmdW5jdGlvbiBoYW5kbGVRdWV1ZVVwZGF0ZShwYXlsb2FkKSB7XG4gICAgICAgIHN0YXRlLmFjdGl2ZUpvYnMgPSBwYXlsb2FkLmpvYnMgfHwgW107XG4gICAgfVxuICAgIFxuICAgIC8vIEhhbmRsZSBzeXN0ZW0gc3RhdHVzIHVwZGF0ZXNcbiAgICBmdW5jdGlvbiBoYW5kbGVTeXN0ZW1TdGF0dXMocGF5bG9hZCkge1xuICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblN0YXRlLnVwZGF0ZVN5c3RlbVN0YXR1cyhzdGF0ZSwgcGF5bG9hZC5zdGF0dXMpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICAvLyBFeHBvc2Ugc3RhdGVcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIFxuICAgICAgICAvLyBJbml0aWFsaXphdGlvblxuICAgICAgICBhc3luYyBpbml0KCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBMb2FkIGluaXRpYWwgZGF0YVxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMubG9hZERhdGEoKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBMb2FkIHBhcmFtZXRlcnMgZnJvbSBVUkxcbiAgICAgICAgICAgICAgICBjb25zdCB1cmxQYXJhbXMgPSB3aW5kb3cuZ2VuZXJhdGlvblVJLnVybC5sb2FkR2VuZXJhdGlvblBhcmFtcygpO1xuICAgICAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyh1cmxQYXJhbXMpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmdlbmVyYXRpb25TdGF0ZS51cGRhdGVQYXJhbXMoc3RhdGUsIHVybFBhcmFtcyk7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5nZW5lcmF0aW9uVUkudG9hc3QuaW5mbygnUGFyYW1ldGVycyBsb2FkZWQgZnJvbSBVUkwnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTG9hZCB1c2VyIHByZWZlcmVuY2VzXG4gICAgICAgICAgICAgICAgY29uc3QgcHJlZmVyZW5jZXMgPSB3aW5kb3cuZ2VuZXJhdGlvblVJLnN0b3JhZ2UubG9hZFByZWZlcmVuY2VzKCk7XG4gICAgICAgICAgICAgICAgaWYgKHByZWZlcmVuY2VzLmF1dG9TYXZlUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dXBBdXRvU2F2ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBJbml0aWFsaXplIFdlYlNvY2tldCBjb25uZWN0aW9uXG4gICAgICAgICAgICAgICAgd3NNYW5hZ2VyLmNvbm5lY3QoKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBTZXR1cCBrZXlib2FyZCBzaG9ydGN1dHNcbiAgICAgICAgICAgICAgICB0aGlzLnNldHVwS2V5Ym9hcmRTaG9ydGN1dHMoKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBTdGFydCBwb2xsaW5nIGFzIGZhbGxiYWNrXG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydFBvbGxpbmcoKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmdlbmVyYXRpb25VSS50b2FzdC5lcnJvcignRmFpbGVkIHRvIGluaXRpYWxpemUgR2VuZXJhdGlvbiBTdHVkaW8nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIC8vIERhdGEgbG9hZGluZyBtZXRob2RzXG4gICAgICAgIGFzeW5jIGxvYWREYXRhKCkge1xuICAgICAgICAgICAgY29uc3QgW3N5c3RlbVJlc3VsdCwgam9ic1Jlc3VsdCwgcmVzdWx0c1Jlc3VsdF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgICAgICAgICAgd2luZG93LmdlbmVyYXRpb25BUEkubG9hZFN5c3RlbVN0YXR1cygpLFxuICAgICAgICAgICAgICAgIHdpbmRvdy5nZW5lcmF0aW9uQVBJLmxvYWRBY3RpdmVKb2JzKCksXG4gICAgICAgICAgICAgICAgd2luZG93LmdlbmVyYXRpb25BUEkubG9hZFJlY2VudFJlc3VsdHMoc3RhdGUuc2hvd0hpc3RvcnkgPyA1MCA6IDEwKVxuICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChzeXN0ZW1SZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5nZW5lcmF0aW9uU3RhdGUudXBkYXRlU3lzdGVtU3RhdHVzKHN0YXRlLCBzeXN0ZW1SZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChqb2JzUmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICBzdGF0ZS5hY3RpdmVKb2JzID0gam9ic1Jlc3VsdC5kYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAocmVzdWx0c1Jlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgc3RhdGUucmVjZW50UmVzdWx0cyA9IHJlc3VsdHNSZXN1bHQuZGF0YS5tYXAocmVzdWx0ID0+IFxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblJlc3VsdHMuZm9ybWF0UmVzdWx0KHJlc3VsdClcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgYXN5bmMgcmVmcmVzaERhdGEoKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmxvYWREYXRhKCk7XG4gICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblVJLnRvYXN0LnN1Y2Nlc3MoJ0RhdGEgcmVmcmVzaGVkJyk7XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICAvLyBHZW5lcmF0aW9uIG1ldGhvZHNcbiAgICAgICAgYXN5bmMgc3RhcnRHZW5lcmF0aW9uKCkge1xuICAgICAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHdpbmRvdy5nZW5lcmF0aW9uVUkudmFsaWRhdGlvbi52YWxpZGF0ZVByb21wdChzdGF0ZS5wYXJhbXMucHJvbXB0KTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmdlbmVyYXRpb25VSS50b2FzdC5lcnJvcih2YWxpZGF0aW9uLmVycm9yc1swXSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblN0YXRlLnNldEdlbmVyYXRpb25TdGF0dXMoc3RhdGUsIHRydWUpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHdpbmRvdy5nZW5lcmF0aW9uQVBJLnN0YXJ0R2VuZXJhdGlvbihzdGF0ZS5wYXJhbXMpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAvLyBBZGQgam9iIHRvIHN0YXRlXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5nZW5lcmF0aW9uU3RhdGUuYWRkQWN0aXZlSm9iKHN0YXRlLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogcmVzdWx0LmRhdGEuam9iX2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgLi4uc3RhdGUucGFyYW1zLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiByZXN1bHQuZGF0YS5zdGF0dXMgfHwgJ3F1ZXVlZCdcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblVJLnRvYXN0LnN1Y2Nlc3MoJ0dlbmVyYXRpb24gc3RhcnRlZCBzdWNjZXNzZnVsbHknKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIFNhdmUgcGFyYW1ldGVycyB0byBVUkwgaWYgYXV0by1zYXZlIGlzIGVuYWJsZWRcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJlZmVyZW5jZXMgPSB3aW5kb3cuZ2VuZXJhdGlvblVJLnN0b3JhZ2UubG9hZFByZWZlcmVuY2VzKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcmVmZXJlbmNlcy5hdXRvU2F2ZVBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmdlbmVyYXRpb25VSS51cmwuc2F2ZUdlbmVyYXRpb25QYXJhbXMoc3RhdGUucGFyYW1zKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5nZW5lcmF0aW9uVUkudG9hc3QuZXJyb3IocmVzdWx0LmVycm9yIHx8ICdHZW5lcmF0aW9uIGZhaWxlZCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmdlbmVyYXRpb25VSS50b2FzdC5lcnJvcignRXJyb3Igc3RhcnRpbmcgZ2VuZXJhdGlvbicpO1xuICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblN0YXRlLnNldEdlbmVyYXRpb25TdGF0dXMoc3RhdGUsIGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGFzeW5jIGNhbmNlbEpvYihqb2JJZCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB3aW5kb3cuZ2VuZXJhdGlvbkFQSS5jYW5jZWxKb2Ioam9iSWQpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblN0YXRlLnJlbW92ZUFjdGl2ZUpvYihzdGF0ZSwgam9iSWQpO1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblVJLnRvYXN0LnN1Y2Nlc3MoJ0dlbmVyYXRpb24gY2FuY2VsbGVkJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmdlbmVyYXRpb25VSS50b2FzdC5lcnJvcignRmFpbGVkIHRvIGNhbmNlbCBnZW5lcmF0aW9uJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblVJLnRvYXN0LmVycm9yKCdFcnJvciBjYW5jZWxsaW5nIGdlbmVyYXRpb24nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGFzeW5jIGNsZWFyUXVldWUoKSB7XG4gICAgICAgICAgICBjb25zdCBxdWV1ZWRKb2JzID0gc3RhdGUuYWN0aXZlSm9icy5maWx0ZXIoam9iID0+IGpvYi5zdGF0dXMgPT09ICdxdWV1ZWQnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHF1ZXVlZEpvYnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmdlbmVyYXRpb25VSS50b2FzdC5pbmZvKCdObyBxdWV1ZWQgam9icyB0byBjbGVhcicpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgY29uZmlybWVkID0gY29uZmlybShgQ2xlYXIgJHtxdWV1ZWRKb2JzLmxlbmd0aH0gcXVldWVkIGpvYihzKT9gKTtcbiAgICAgICAgICAgIGlmICghY29uZmlybWVkKSByZXR1cm47XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJvbWlzZXMgPSBxdWV1ZWRKb2JzLm1hcChqb2IgPT4gdGhpcy5jYW5jZWxKb2Ioam9iLmlkKSk7XG4gICAgICAgICAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5nZW5lcmF0aW9uVUkudG9hc3Quc3VjY2VzcyhgQ2xlYXJlZCAke3F1ZXVlZEpvYnMubGVuZ3RofSBxdWV1ZWQgam9ic2ApO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblVJLnRvYXN0LmVycm9yKCdFcnJvciBjbGVhcmluZyBxdWV1ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgLy8gUmVzdWx0IG1hbmFnZW1lbnQgbWV0aG9kc1xuICAgICAgICBzaG93SW1hZ2VNb2RhbChyZXN1bHQpIHtcbiAgICAgICAgICAgIHdpbmRvdy5nZW5lcmF0aW9uU3RhdGUuc2hvd1Jlc3VsdE1vZGFsKHN0YXRlLCByZXN1bHQpO1xuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgaGlkZUltYWdlTW9kYWwoKSB7XG4gICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblN0YXRlLmhpZGVSZXN1bHRNb2RhbChzdGF0ZSk7XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICByZXVzZVBhcmFtZXRlcnMocmVzdWx0KSB7XG4gICAgICAgICAgICBjb25zdCBwYXJhbXMgPSB3aW5kb3cuZ2VuZXJhdGlvblJlc3VsdHMuZXh0cmFjdFBhcmFtZXRlcnMocmVzdWx0KTtcbiAgICAgICAgICAgIGlmIChwYXJhbXMpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblN0YXRlLnVwZGF0ZVBhcmFtcyhzdGF0ZSwgcGFyYW1zKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblVJLnRvYXN0LnN1Y2Nlc3MoJ1BhcmFtZXRlcnMgbG9hZGVkIGZyb20gcmVzdWx0Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBhc3luYyBkZWxldGVSZXN1bHQocmVzdWx0SWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbmZpcm1lZCA9IGNvbmZpcm0oJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyByZXN1bHQ/Jyk7XG4gICAgICAgICAgICBpZiAoIWNvbmZpcm1lZCkgcmV0dXJuO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHdpbmRvdy5nZW5lcmF0aW9uQVBJLmRlbGV0ZVJlc3VsdChyZXN1bHRJZCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5nZW5lcmF0aW9uU3RhdGUucmVtb3ZlUmVjZW50UmVzdWx0KHN0YXRlLCByZXN1bHRJZCk7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5nZW5lcmF0aW9uVUkudG9hc3Quc3VjY2VzcygnUmVzdWx0IGRlbGV0ZWQnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblVJLnRvYXN0LmVycm9yKCdGYWlsZWQgdG8gZGVsZXRlIHJlc3VsdCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmdlbmVyYXRpb25VSS50b2FzdC5lcnJvcignRXJyb3IgZGVsZXRpbmcgcmVzdWx0Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBhc3luYyBkb3dubG9hZFJlc3VsdChyZXN1bHQpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB3aW5kb3cuZ2VuZXJhdGlvbkFQSS5kb3dubG9hZFJlc3VsdChyZXN1bHQuaWQpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5nZW5lcmF0aW9uVUkuZG93bmxvYWQuYmxvYihyZXNwb25zZS5kYXRhLmJsb2IsIHJlc3BvbnNlLmRhdGEuZmlsZW5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblVJLnRvYXN0LnN1Y2Nlc3MoJ0Rvd25sb2FkIHN0YXJ0ZWQnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblVJLnRvYXN0LmVycm9yKCdEb3dubG9hZCBmYWlsZWQnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5nZW5lcmF0aW9uVUkudG9hc3QuZXJyb3IoJ0Vycm9yIGRvd25sb2FkaW5nIHJlc3VsdCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgLy8gUXVpY2sgYWN0aW9uIG1ldGhvZHNcbiAgICAgICAgdXNlUmFuZG9tUHJvbXB0KCkge1xuICAgICAgICAgICAgY29uc3QgcmFuZG9tUHJvbXB0ID0gd2luZG93LmdlbmVyYXRpb25VSS5yYW5kb20uZ2V0UHJvbXB0KCk7XG4gICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblN0YXRlLnVwZGF0ZVBhcmFtcyhzdGF0ZSwgeyBwcm9tcHQ6IHJhbmRvbVByb21wdCB9KTtcbiAgICAgICAgICAgIHdpbmRvdy5nZW5lcmF0aW9uVUkudG9hc3Quc3VjY2VzcygnUmFuZG9tIHByb21wdCBnZW5lcmF0ZWQnKTtcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIHVzZVJhbmRvbVNlZWQoKSB7XG4gICAgICAgICAgICBjb25zdCByYW5kb21TZWVkID0gd2luZG93LmdlbmVyYXRpb25VSS5yYW5kb20uZ2V0U2VlZCgpO1xuICAgICAgICAgICAgd2luZG93LmdlbmVyYXRpb25TdGF0ZS51cGRhdGVQYXJhbXMoc3RhdGUsIHsgc2VlZDogcmFuZG9tU2VlZCB9KTtcbiAgICAgICAgICAgIHdpbmRvdy5nZW5lcmF0aW9uVUkudG9hc3Quc3VjY2VzcygnUmFuZG9tIHNlZWQgZ2VuZXJhdGVkJyk7XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBzYXZlQXNQcmVzZXQoKSB7XG4gICAgICAgICAgICBjb25zdCBuYW1lID0gcHJvbXB0KCdFbnRlciBhIG5hbWUgZm9yIHRoaXMgcHJlc2V0OicpO1xuICAgICAgICAgICAgaWYgKCFuYW1lIHx8ICFuYW1lLnRyaW0oKSkgcmV0dXJuO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHByZXNldCA9IHdpbmRvdy5nZW5lcmF0aW9uVUkuc3RvcmFnZS5zYXZlUHJlc2V0KG5hbWUudHJpbSgpLCBzdGF0ZS5wYXJhbXMpO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5nZW5lcmF0aW9uVUkudG9hc3Quc3VjY2VzcyhgUHJlc2V0IFwiJHtwcmVzZXQubmFtZX1cIiBzYXZlZGApO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblVJLnRvYXN0LmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBwcmVzZXQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGxvYWRQcmVzZXQocHJlc2V0KSB7XG4gICAgICAgICAgICBpZiAoIXByZXNldCB8fCAhcHJlc2V0LnBhcmFtcykgcmV0dXJuO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblN0YXRlLnVwZGF0ZVBhcmFtcyhzdGF0ZSwgcHJlc2V0LnBhcmFtcyk7XG4gICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblVJLnRvYXN0LnN1Y2Nlc3MoYFByZXNldCBcIiR7cHJlc2V0Lm5hbWV9XCIgbG9hZGVkYCk7XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICAvLyBVSSB1dGlsaXR5IG1ldGhvZHNcbiAgICAgICAgdG9nZ2xlSGlzdG9yeSgpIHtcbiAgICAgICAgICAgIGNvbnN0IHNob3dIaXN0b3J5ID0gd2luZG93LmdlbmVyYXRpb25TdGF0ZS50b2dnbGVIaXN0b3J5KHN0YXRlKTtcbiAgICAgICAgICAgIHRoaXMubG9hZFJlY2VudFJlc3VsdHMoc2hvd0hpc3RvcnkgPyA1MCA6IDEwKTtcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGFzeW5jIGNvcHlQcm9tcHQocHJvbXB0KSB7XG4gICAgICAgICAgICBjb25zdCBzdWNjZXNzID0gYXdhaXQgd2luZG93LmdlbmVyYXRpb25VSS5jbGlwYm9hcmQuY29weVRleHQocHJvbXB0KTtcbiAgICAgICAgICAgIGlmIChzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmdlbmVyYXRpb25VSS50b2FzdC5zdWNjZXNzKCdQcm9tcHQgY29waWVkIHRvIGNsaXBib2FyZCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblVJLnRvYXN0LmVycm9yKCdGYWlsZWQgdG8gY29weSBwcm9tcHQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGFzeW5jIGNvcHlQYXJhbWV0ZXJzKHJlc3VsdCkge1xuICAgICAgICAgICAgY29uc3QgcGFyYW1zID0gd2luZG93LmdlbmVyYXRpb25SZXN1bHRzLmV4dHJhY3RQYXJhbWV0ZXJzKHJlc3VsdCk7XG4gICAgICAgICAgICBjb25zdCBzdWNjZXNzID0gYXdhaXQgd2luZG93LmdlbmVyYXRpb25VSS5jbGlwYm9hcmQuY29weVBhcmFtcyhwYXJhbXMpO1xuICAgICAgICAgICAgaWYgKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblVJLnRvYXN0LnN1Y2Nlc3MoJ1BhcmFtZXRlcnMgY29waWVkIHRvIGNsaXBib2FyZCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuZ2VuZXJhdGlvblVJLnRvYXN0LmVycm9yKCdGYWlsZWQgdG8gY29weSBwYXJhbWV0ZXJzJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICAvLyBQcm9ncmVzcyBhbmQgc3RhdHVzIG1ldGhvZHNcbiAgICAgICAgZ2V0Sm9iUHJvZ3Jlc3Moam9iKSB7XG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmdlbmVyYXRpb25Qcm9ncmVzcy5nZXRQcm9ncmVzc0JhckNvbmZpZyhqb2IpO1xuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgZm9ybWF0RHVyYXRpb24oc2Vjb25kcykge1xuICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5nZW5lcmF0aW9uUHJvZ3Jlc3MuZm9ybWF0RHVyYXRpb24oc2Vjb25kcyk7XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBmb3JtYXRGaWxlU2l6ZShieXRlcykge1xuICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5nZW5lcmF0aW9uUmVzdWx0cy5mb3JtYXRGaWxlU2l6ZShieXRlcyk7XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBmb3JtYXREYXRlKGRhdGVTdHJpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuZ2VuZXJhdGlvblJlc3VsdHMuZm9ybWF0RGF0ZShkYXRlU3RyaW5nKTtcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGdldFN0YXRpc3RpY3MoKSB7XG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmdlbmVyYXRpb25TdGF0ZS5nZXRTdGF0aXN0aWNzKHN0YXRlKTtcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIC8vIFNldHVwIG1ldGhvZHNcbiAgICAgICAgc2V0dXBBdXRvU2F2ZSgpIHtcbiAgICAgICAgICAgIC8vIFNhdmUgcGFyYW1ldGVycyB0byBsb2NhbFN0b3JhZ2UgcGVyaW9kaWNhbGx5XG4gICAgICAgICAgICBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgd2luZG93LmdlbmVyYXRpb25VSS5zdG9yYWdlLnNldCgnbGFzdFBhcmFtcycsIHN0YXRlLnBhcmFtcyk7XG4gICAgICAgICAgICB9LCAzMDAwMCk7IC8vIEV2ZXJ5IDMwIHNlY29uZHNcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIHNldHVwS2V5Ym9hcmRTaG9ydGN1dHMoKSB7XG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmdlbmVyYXRpb25VSS5rZXlib2FyZC5pbml0KHtcbiAgICAgICAgICAgICAgICBzdGFydEdlbmVyYXRpb246ICgpID0+IHRoaXMuc3RhcnRHZW5lcmF0aW9uKCksXG4gICAgICAgICAgICAgICAgcmVmcmVzaFJlc3VsdHM6ICgpID0+IHRoaXMucmVmcmVzaERhdGEoKSxcbiAgICAgICAgICAgICAgICBzYXZlUHJlc2V0OiAoKSA9PiB0aGlzLnNhdmVBc1ByZXNldCgpLFxuICAgICAgICAgICAgICAgIGNsZWFyUXVldWU6ICgpID0+IHRoaXMuY2xlYXJRdWV1ZSgpLFxuICAgICAgICAgICAgICAgIHJhbmRvbVByb21wdDogKCkgPT4gdGhpcy51c2VSYW5kb21Qcm9tcHQoKSxcbiAgICAgICAgICAgICAgICBjbG9zZU1vZGFsOiAoKSA9PiB0aGlzLmhpZGVJbWFnZU1vZGFsKClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgc3RhcnRQb2xsaW5nKCkge1xuICAgICAgICAgICAgaWYgKHN0YXRlLnBvbGxJbnRlcnZhbCkgcmV0dXJuO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBzdGF0ZS5wb2xsSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmFjdGl2ZUpvYnMubGVuZ3RoID4gMCB8fCAhd3NNYW5hZ2VyLmlzQ29ubmVjdGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgd2luZG93LmdlbmVyYXRpb25BUEkubG9hZEFjdGl2ZUpvYnMoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5hY3RpdmVKb2JzID0gcmVzdWx0LmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBzdGF0ZS5jb25maWcucG9sbEludGVydmFsTXMpO1xuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgc3RvcFBvbGxpbmcoKSB7XG4gICAgICAgICAgICBpZiAoc3RhdGUucG9sbEludGVydmFsKSB7XG4gICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChzdGF0ZS5wb2xsSW50ZXJ2YWwpO1xuICAgICAgICAgICAgICAgIHN0YXRlLnBvbGxJbnRlcnZhbCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICAvLyBDbGVhbnVwXG4gICAgICAgIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICB0aGlzLnN0b3BQb2xsaW5nKCk7XG4gICAgICAgICAgICB3c01hbmFnZXIuZGVzdHJveSgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAodGhpcy5rZXlib2FyZENsZWFudXApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmtleWJvYXJkQ2xlYW51cCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgLy8gQWxwaW5lLmpzIHJlYWN0aXZlIGdldHRlcnNcbiAgICAgICAgZ2V0IHNvcnRlZEFjdGl2ZUpvYnMoKSB7XG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmdlbmVyYXRpb25Qcm9ncmVzcy5zb3J0Sm9ic0J5UHJpb3JpdHkoc3RhdGUuYWN0aXZlSm9icyk7XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBnZXQgcmVjZW50UmVzdWx0c0Rpc3BsYXkoKSB7XG4gICAgICAgICAgICByZXR1cm4gc3RhdGUucmVjZW50UmVzdWx0cy5zbGljZSgwLCBzdGF0ZS5zaG93SGlzdG9yeSA/IDUwIDogMTApO1xuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgZ2V0IHN5c3RlbUhlYWx0aCgpIHtcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuZ2VuZXJhdGlvblN0YXRlLmlzU3lzdGVtSGVhbHRoeShzdGF0ZSk7XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBnZXQgY29ubmVjdGlvblN0YXR1cygpIHtcbiAgICAgICAgICAgIHJldHVybiB3c01hbmFnZXIuZ2V0U3RhdHVzKCk7XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBnZXQgaGFzQWN0aXZlSm9icygpIHtcbiAgICAgICAgICAgIHJldHVybiBzdGF0ZS5hY3RpdmVKb2JzLmxlbmd0aCA+IDA7XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBnZXQgaGFzUmVjZW50UmVzdWx0cygpIHtcbiAgICAgICAgICAgIHJldHVybiBzdGF0ZS5yZWNlbnRSZXN1bHRzLmxlbmd0aCA+IDA7XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBnZXQgY2FuR2VuZXJhdGUoKSB7XG4gICAgICAgICAgICByZXR1cm4gIXN0YXRlLmlzR2VuZXJhdGluZyAmJiBzdGF0ZS5wYXJhbXMucHJvbXB0LnRyaW0oKS5sZW5ndGggPiAwO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuLy8gRXhwb3J0IGZvciB1c2UgaW4gdGVtcGxhdGVzXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICB3aW5kb3cuZ2VuZXJhdGlvblN0dWRpbyA9IGdlbmVyYXRpb25TdHVkaW87XG59XG5cbi8vIEV4cG9ydCBmb3IgQ29tbW9uSlMgdGVzdGluZyBlbnZpcm9ubWVudHNcbmlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgIG1vZHVsZS5leHBvcnRzID0geyBnZW5lcmF0aW9uU3R1ZGlvIH07XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBU0EsZ0JBQWdCQSxDQUFBLEVBQUc7RUFDeEI7RUFDQSxNQUFNQyxLQUFLLEdBQUdDLE1BQU0sQ0FBQ0MsZUFBZSxDQUFDQyxrQkFBa0IsQ0FBQyxDQUFDOztFQUV6RDtFQUNBLE1BQU1DLFNBQVMsR0FBR0gsTUFBTSxDQUFDSSxtQkFBbUIsQ0FBQ0MsdUJBQXVCLENBQUM7SUFDakVDLE1BQU0sRUFBRUEsQ0FBQSxLQUFNO01BQ1ZOLE1BQU0sQ0FBQ0MsZUFBZSxDQUFDTSxtQkFBbUIsQ0FBQ1IsS0FBSyxFQUFFLElBQUksQ0FBQztNQUN2REMsTUFBTSxDQUFDUSxZQUFZLENBQUNDLEtBQUssQ0FBQ0MsT0FBTyxDQUFDLGdDQUFnQyxDQUFDO0lBQ3ZFLENBQUM7SUFFREMsU0FBUyxFQUFHQyxXQUFXLElBQUs7TUFDeEJDLHNCQUFzQixDQUFDRCxXQUFXLENBQUM7SUFDdkMsQ0FBQztJQUVERSxPQUFPLEVBQUVBLENBQUEsS0FBTTtNQUNYZCxNQUFNLENBQUNDLGVBQWUsQ0FBQ00sbUJBQW1CLENBQUNSLEtBQUssRUFBRSxLQUFLLENBQUM7SUFDNUQsQ0FBQztJQUVEZ0IsT0FBTyxFQUFHQyxNQUFNLElBQUs7TUFDakJoQixNQUFNLENBQUNRLFlBQVksQ0FBQ0MsS0FBSyxDQUFDUSxLQUFLLENBQUMsb0RBQW9ELENBQUM7SUFDekY7RUFDSixDQUFDLENBQUM7O0VBRUY7RUFDQSxTQUFTSixzQkFBc0JBLENBQUNELFdBQVcsRUFBRTtJQUN6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bEI3SSxTQUFTLENBQUMrSSxPQUFPLENBQUMsQ0FBQztNQUVuQixJQUFJLElBQUksQ0FBQ0MsZUFBZSxFQUFFO1FBQ3RCLElBQUksQ0FBQ0EsZUFBZSxDQUFDLENBQUM7TUFDMUI7SUFDSixDQUFDO0lBRUQ7SUFDQSxJQUFJQyxnQkFBZ0JBLENBQUEsRUFBRztNQUNuQixPQUFPcEosTUFBTSxDQUFDNkIsa0JBQWtCLENBQUN3SCxrQkFBa0IsQ0FBQ3RKLEtBQUssQ0FBQ21DLFVBQVUsQ0FBQztJQUN6RSxDQUFDO0lBRUQsSUFBSW9ILG9CQUFvQkEsQ0FBQSxFQUFHO01BQ3ZCLE9BQU92SixLQUFLLENBQUNvRSxhQUFhLENBQUNvRixLQUFLLENBQUMsQ0FBQyxFQUFFeEosS0FBSyxDQUFDa0UsV0FBVyxHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUM7SUFDcEUsQ0FBQztJQUVELElBQUl1RixZQUFZQSxDQUFBLEVBQUc7TUFDZixPQUFPeEosTUFBTSxDQUFDQyxlQUFlLENBQUN3SixlQUFlLENBQUMxSixLQUFLLENBQUM7SUFDeEQsQ0FBQztJQUVELElBQUkySixnQkFBZ0JBLENBQUEsRUFBRztNQUNuQixPQUFPdkosU0FBUyxDQUFDd0osU0FBUyxDQUFDLENBQUM7SUFDaEMsQ0FBQztJQUVELElBQUlDLGFBQWFBLENBQUEsRUFBRztNQUNoQixPQUFPN0osS0FBSyxDQUFDbUMsVUFBVSxDQUFDVyxNQUFNLEdBQUcsQ0FBQztJQUN0QyxDQUFDO0lBRUQsSUFBSWdILGdCQUFnQkEsQ0FBQSxFQUFHO01BQ25CLE9BQU85SixLQUFLLENBQUNvRSxhQUFhLENBQUN0QixNQUFNLEdBQUcsQ0FBQztJQUN6QyxDQUFDO0lBRUQsSUFBSWlILFdBQVdBLENBQUEsRUFBRztNQUNkLE9BQU8sQ0FBQy9KLEtBQUssQ0FBQ2dLLFlBQVksSUFBSWhLLEtBQUssQ0FBQzZFLE1BQU0sQ0FBQ0MsTUFBTSxDQUFDdUMsSUFBSSxDQUFDLENBQUMsQ0FBQ3ZFLE1BQU0sR0FBRyxDQUFDO0lBQ3ZFO0VBQ0osQ0FBQztBQUNMOztBQUVBO0FBQ0EsSUFBSSxPQUFPN0MsTUFBTSxLQUFLLFdBQVcsRUFBRTtFQUMvQkEsTUFBTSxDQUFDRixnQkFBZ0IsR0FBR0EsZ0JBQWdCO0FBQzlDOztBQUVBO0FBQ0EsSUFBSSxPQUFPa0ssTUFBTSxLQUFLLFdBQVcsSUFBSUEsTUFBTSxDQUFDQyxPQUFPLEVBQUU7RUFDakRELE1BQU0sQ0FBQ0MsT0FBTyxHQUFHO0lBQUVuSztFQUFpQixDQUFDO0FBQ3pDIiwiaWdub3JlTGlzdCI6W119