{# 
LoRA Manager - UI Component Macros

Reusable Jinja2 macros for common UI components used throughout
the LoRA Manager frontend interface.
#}

{# Progress Bar Component #}
{% macro progress_bar(value, max_value=100, color_class="bg-blue-600", size="h-2") %}
{% set pct = (value / max_value * 100) | round(1) %}
<div class="progress-bar-container {{ size }}">
    <div 
        class="progress-bar-value {{ color_class }} {{ size }}"
        style="width: {{ pct ~ '%' }};"
    ></div>
</div>
{% endmacro %}

{# Status Badge Component #}
{% macro status_badge(is_active, active_text="Active", inactive_text="Inactive") %}
<span class="status-badge {{ 'status-active' if is_active else 'status-inactive' }}">
    {{ active_text if is_active else inactive_text }}
</span>
{% endmacro %}

{# Similarity Score Component #}
{% macro similarity_score(score, label, color_class="bg-blue-500") %}
{% set pct = (score * 100) | round(1) %}
{% set pct_display = (score * 100) | round(0) %}
<div class="similarity-score-container">
    <span class="text-gray-600">{{ label }}</span>
    <div class="similarity-score-visual">
        <div class="similarity-score-bar-bg">
            <div 
                class="similarity-score-bar-value {{ color_class }}"
                style="width: {{ pct ~ '%' }};"
            ></div>
        </div>
        <span class="similarity-score-text">
            {{ pct_display }}%
        </span>
    </div>
</div>
{% endmacro %}

{# Loading Spinner Component #}
{% macro loading_spinner(size="w-4 h-4", text="Loading...") %}
<div class="loading-spinner-container">
    <svg class="animate-spin {{ size }} text-gray-500" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
    </svg>
    {% if text %}
        <span class="loading-spinner-text">{{ text }}</span>
    {% endif %}
</div>
{% endmacro %}

{# Action Button Component #}
{% macro action_button(onclick, text, icon_svg="", variant="primary", size="md", disabled=false) %}
<button 
    onclick="{{ onclick }}"
    {% if disabled %}disabled{% endif %}
    class="btn btn-{{ size }} btn-{{ variant }}"
>
    {% if icon_svg %}
        {{ icon_svg|safe }}
    {% endif %}
    {{ text }}
</button>
{% endmacro %}

{# Tag Component #}
{% macro tag(text, color="purple", size="sm") %}
<span class="tag tag-{{ size }} tag-{{ color }}">
    {{ text }}
</span>
{% endmacro %}

{# Card Container Component #}
{% macro card(title="", class="", body_class="") %}
<div class="card {{ 'card-interactive' if 'hover:' in class }} {{ class }}">
    {% if title %}
    <div class="card-header">
        <h5 class="card-title">{{ title }}</h5>
    </div>
    {% endif %}
    <div class="card-body {{ body_class }}">
        {{ caller() }}
    </div>
</div>
{% endmacro %}

{# Error Message Component #}
{% macro error_message(message, dismissible=true) %}
<div class="alert alert-danger" {% if dismissible %}x-data="{ show: true }" x-show="show" x-transition{% endif %}>
    <div class="alert-icon">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
    </div>
    <div class="alert-content">
        <p>{{ message }}</p>
    </div>
    {% if dismissible %}
    <div class="alert-close">
        <button @click="show = false">
            <span class="sr-only">Dismiss</span>
            <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
        </button>
    </div>
    {% endif %}
</div>
{% endmacro %}

{# Success Message Component #}
{% macro success_message(message, dismissible=true) %}
<div class="alert alert-success" {% if dismissible %}x-data="{ show: true }" x-show="show" x-transition{% endif %}>
    <div class="alert-icon">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
    </div>
    <div class="alert-content">
        <p>{{ message }}</p>
    </div>
    {% if dismissible %}
    <div class="alert-close">
        <button @click="show = false">
            <span class="sr-only">Dismiss</span>
            <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
        </button>
    </div>
    {% endif %}
</div>
{% endmacro %}

{# Empty State Component #}
{% macro empty_state(title, description, icon_svg="", action_text="", action_onclick="") %}
<div class="empty-state">
    {% if icon_svg %}
        <div class="empty-state-icon">
            {{ icon_svg|safe }}
        </div>
    {% endif %}
    <h3 class="empty-state-title">{{ title }}</h3>
    <p class="empty-state-description">{{ description }}</p>
    {% if action_text and action_onclick %}
    <div class="empty-state-actions">
        {{ action_button(action_onclick, action_text, variant="primary", size="md") }}
    </div>
    {% endif %}
</div>
{% endmacro %}

{# Weight Slider Component #}
{% macro weight_slider(label, model_var, color="blue", min=0, max=1, step=0.1) %}
<div>
    <label class="form-label">
        {{ label }}
        <span class="slider-value text-{{ color }}-600" x-text="{{ model_var }}"></span>
    </label>
    <input 
        type="range" 
        x-model.number="{{ model_var }}" 
        min="{{ min }}" 
        max="{{ max }}" 
        step="{{ step }}"
        class="form-range slider-{{ color }}"
    />
</div>
{% endmacro %}
